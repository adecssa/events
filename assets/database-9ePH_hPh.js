function Jr(e,t){return t={exports:{}},e(t,t.exports),t.exports}var Vr=Yr,Wr=Kr,Hr=Qr,tt=[],H=[],Gr=typeof Uint8Array<"u"?Uint8Array:Array,ee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var dt=0,Zr=ee.length;dt<Zr;++dt)tt[dt]=ee[dt],H[ee.charCodeAt(dt)]=dt;H[45]=62;H[95]=63;function ar(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");r===-1&&(r=t);var o=r===t?0:4-r%4;return[r,o]}function Yr(e){var t=ar(e),r=t[0],o=t[1];return(r+o)*3/4-o}function qr(e,t,r){return(t+r)*3/4-r}function Kr(e){var t,r=ar(e),o=r[0],f=r[1],u=new Gr(qr(e,o,f)),s=0,l=f>0?o-4:o,d;for(d=0;d<l;d+=4)t=H[e.charCodeAt(d)]<<18|H[e.charCodeAt(d+1)]<<12|H[e.charCodeAt(d+2)]<<6|H[e.charCodeAt(d+3)],u[s++]=t>>16&255,u[s++]=t>>8&255,u[s++]=t&255;return f===2&&(t=H[e.charCodeAt(d)]<<2|H[e.charCodeAt(d+1)]>>4,u[s++]=t&255),f===1&&(t=H[e.charCodeAt(d)]<<10|H[e.charCodeAt(d+1)]<<4|H[e.charCodeAt(d+2)]>>2,u[s++]=t>>8&255,u[s++]=t&255),u}function Xr(e){return tt[e>>18&63]+tt[e>>12&63]+tt[e>>6&63]+tt[e&63]}function zr(e,t,r){for(var o,f=[],u=t;u<r;u+=3)o=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(e[u+2]&255),f.push(Xr(o));return f.join("")}function Qr(e){for(var t,r=e.length,o=r%3,f=[],u=16383,s=0,l=r-o;s<l;s+=u)f.push(zr(e,s,s+u>l?l:s+u));return o===1?(t=e[r-1],f.push(tt[t>>2]+tt[t<<4&63]+"==")):o===2&&(t=(e[r-2]<<8)+e[r-1],f.push(tt[t>>10]+tt[t>>4&63]+tt[t<<2&63]+"=")),f.join("")}var re={byteLength:Vr,toByteArray:Wr,fromByteArray:Hr};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var tn=function(t,r,o,f,u){var s,l,d=u*8-f-1,w=(1<<d)-1,m=w>>1,y=-7,x=o?u-1:0,_=o?-1:1,v=t[r+x];for(x+=_,s=v&(1<<-y)-1,v>>=-y,y+=d;y>0;s=s*256+t[r+x],x+=_,y-=8);for(l=s&(1<<-y)-1,s>>=-y,y+=f;y>0;l=l*256+t[r+x],x+=_,y-=8);if(s===0)s=1-m;else{if(s===w)return l?NaN:(v?-1:1)*(1/0);l=l+Math.pow(2,f),s=s-m}return(v?-1:1)*l*Math.pow(2,s-f)},en=function(t,r,o,f,u,s){var l,d,w,m=s*8-u-1,y=(1<<m)-1,x=y>>1,_=u===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=f?0:s-1,A=f?1:-1,j=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(d=isNaN(r)?1:0,l=y):(l=Math.floor(Math.log(r)/Math.LN2),r*(w=Math.pow(2,-l))<1&&(l--,w*=2),l+x>=1?r+=_/w:r+=_*Math.pow(2,1-x),r*w>=2&&(l++,w/=2),l+x>=y?(d=0,l=y):l+x>=1?(d=(r*w-1)*Math.pow(2,u),l=l+x):(d=r*Math.pow(2,x-1)*Math.pow(2,u),l=0));u>=8;t[o+v]=d&255,v+=A,d/=256,u-=8);for(l=l<<u|d,m+=u;m>0;t[o+v]=l&255,v+=A,l/=256,m-=8);t[o+v-A]|=j*128},gt={read:tn,write:en},Wt=Jr(function(e,t){var r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=F,t.INSPECT_MAX_BYTES=50;var o=2147483647;t.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=f(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{var a=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(a,n),a.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}});function u(a){if(a>o)throw new RangeError('The value "'+a+'" is invalid for option "size"');var n=new Uint8Array(a);return Object.setPrototypeOf(n,s.prototype),n}function s(a,n,i){if(typeof a=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(a)}return l(a,n,i)}s.poolSize=8192;function l(a,n,i){if(typeof a=="string")return y(a,n);if(ArrayBuffer.isView(a))return _(a);if(a==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(a));if(z(a,ArrayBuffer)||a&&z(a.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(z(a,SharedArrayBuffer)||a&&z(a.buffer,SharedArrayBuffer)))return v(a,n,i);if(typeof a=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var h=a.valueOf&&a.valueOf();if(h!=null&&h!==a)return s.from(h,n,i);var c=A(a);if(c)return c;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof a[Symbol.toPrimitive]=="function")return s.from(a[Symbol.toPrimitive]("string"),n,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(a))}s.from=function(a,n,i){return l(a,n,i)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array);function d(a){if(typeof a!="number")throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function w(a,n,i){return d(a),a<=0?u(a):n!==void 0?typeof i=="string"?u(a).fill(n,i):u(a).fill(n):u(a)}s.alloc=function(a,n,i){return w(a,n,i)};function m(a){return d(a),u(a<0?0:j(a)|0)}s.allocUnsafe=function(a){return m(a)},s.allocUnsafeSlow=function(a){return m(a)};function y(a,n){if((typeof n!="string"||n==="")&&(n="utf8"),!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i=L(a,n)|0,h=u(i),c=h.write(a,n);return c!==i&&(h=h.slice(0,c)),h}function x(a){for(var n=a.length<0?0:j(a.length)|0,i=u(n),h=0;h<n;h+=1)i[h]=a[h]&255;return i}function _(a){if(z(a,Uint8Array)){var n=new Uint8Array(a);return v(n.buffer,n.byteOffset,n.byteLength)}return x(a)}function v(a,n,i){if(n<0||a.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<n+(i||0))throw new RangeError('"length" is outside of buffer bounds');var h;return n===void 0&&i===void 0?h=new Uint8Array(a):i===void 0?h=new Uint8Array(a,n):h=new Uint8Array(a,n,i),Object.setPrototypeOf(h,s.prototype),h}function A(a){if(s.isBuffer(a)){var n=j(a.length)|0,i=u(n);return i.length===0||a.copy(i,0,0,n),i}if(a.length!==void 0)return typeof a.length!="number"||te(a.length)?u(0):x(a);if(a.type==="Buffer"&&Array.isArray(a.data))return x(a.data)}function j(a){if(a>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return a|0}function F(a){return+a!=a&&(a=0),s.alloc(+a)}s.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==s.prototype},s.compare=function(n,i){if(z(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),z(i,Uint8Array)&&(i=s.from(i,i.offset,i.byteLength)),!s.isBuffer(n)||!s.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===i)return 0;for(var h=n.length,c=i.length,p=0,g=Math.min(h,c);p<g;++p)if(n[p]!==i[p]){h=n[p],c=i[p];break}return h<c?-1:c<h?1:0},s.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(n,i){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return s.alloc(0);var h;if(i===void 0)for(i=0,h=0;h<n.length;++h)i+=n[h].length;var c=s.allocUnsafe(i),p=0;for(h=0;h<n.length;++h){var g=n[h];if(z(g,Uint8Array))p+g.length>c.length?s.from(g).copy(c,p):Uint8Array.prototype.set.call(c,g,p);else if(s.isBuffer(g))g.copy(c,p);else throw new TypeError('"list" argument must be an Array of Buffers');p+=g.length}return c};function L(a,n){if(s.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||z(a,ArrayBuffer))return a.byteLength;if(typeof a!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(a));var i=a.length,h=arguments.length>2&&arguments[2]===!0;if(!h&&i===0)return 0;for(var c=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return Qt(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return Ie(a).length;default:if(c)return h?-1:Qt(a).length;n=(""+n).toLowerCase(),c=!0}}s.byteLength=L;function $(a,n,i){var h=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,n>>>=0,i<=n))return"";for(a||(a="utf8");;)switch(a){case"hex":return Y(this,n,i);case"utf8":case"utf-8":return lt(this,n,i);case"ascii":return pt(this,n,i);case"latin1":case"binary":return U(this,n,i);case"base64":return ct(this,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,n,i);default:if(h)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),h=!0}}s.prototype._isBuffer=!0;function E(a,n,i){var h=a[n];a[n]=a[i],a[i]=h}s.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<n;i+=2)E(this,i,i+1);return this},s.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<n;i+=4)E(this,i,i+3),E(this,i+1,i+2);return this},s.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<n;i+=8)E(this,i,i+7),E(this,i+1,i+6),E(this,i+2,i+5),E(this,i+3,i+4);return this},s.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?lt(this,0,n):$.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(n){if(!s.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:s.compare(this,n)===0},s.prototype.inspect=function(){var n="",i=t.INSPECT_MAX_BYTES;return n=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(n+=" ... "),"<Buffer "+n+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(n,i,h,c,p){if(z(n,Uint8Array)&&(n=s.from(n,n.offset,n.byteLength)),!s.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(n));if(i===void 0&&(i=0),h===void 0&&(h=n?n.length:0),c===void 0&&(c=0),p===void 0&&(p=this.length),i<0||h>n.length||c<0||p>this.length)throw new RangeError("out of range index");if(c>=p&&i>=h)return 0;if(c>=p)return-1;if(i>=h)return 1;if(i>>>=0,h>>>=0,c>>>=0,p>>>=0,this===n)return 0;for(var g=p-c,N=h-i,I=Math.min(g,N),B=this.slice(c,p),M=n.slice(i,h),R=0;R<I;++R)if(B[R]!==M[R]){g=B[R],N=M[R];break}return g<N?-1:N<g?1:0};function V(a,n,i,h,c){if(a.length===0)return-1;if(typeof i=="string"?(h=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,te(i)&&(i=c?0:a.length-1),i<0&&(i=a.length+i),i>=a.length){if(c)return-1;i=a.length-1}else if(i<0)if(c)i=0;else return-1;if(typeof n=="string"&&(n=s.from(n,h)),s.isBuffer(n))return n.length===0?-1:X(a,n,i,h,c);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?c?Uint8Array.prototype.indexOf.call(a,n,i):Uint8Array.prototype.lastIndexOf.call(a,n,i):X(a,[n],i,h,c);throw new TypeError("val must be string, number or Buffer")}function X(a,n,i,h,c){var p=1,g=a.length,N=n.length;if(h!==void 0&&(h=String(h).toLowerCase(),h==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(a.length<2||n.length<2)return-1;p=2,g/=2,N/=2,i/=2}function I(Be,Ue){return p===1?Be[Ue]:Be.readUInt16BE(Ue*p)}var B;if(c){var M=-1;for(B=i;B<g;B++)if(I(a,B)===I(n,M===-1?0:B-M)){if(M===-1&&(M=B),B-M+1===N)return M*p}else M!==-1&&(B-=B-M),M=-1}else for(i+N>g&&(i=g-N),B=i;B>=0;B--){for(var R=!0,Ft=0;Ft<N;Ft++)if(I(a,B+Ft)!==I(n,Ft)){R=!1;break}if(R)return B}return-1}s.prototype.includes=function(n,i,h){return this.indexOf(n,i,h)!==-1},s.prototype.indexOf=function(n,i,h){return V(this,n,i,h,!0)},s.prototype.lastIndexOf=function(n,i,h){return V(this,n,i,h,!1)};function rt(a,n,i,h){i=Number(i)||0;var c=a.length-i;h?(h=Number(h),h>c&&(h=c)):h=c;var p=n.length;h>p/2&&(h=p/2);for(var g=0;g<h;++g){var N=parseInt(n.substr(g*2,2),16);if(te(N))return g;a[i+g]=N}return g}function Xt(a,n,i,h){return kt(Qt(n,a.length-i),a,i,h)}function St(a,n,i,h){return kt(Pr(n),a,i,h)}function zt(a,n,i,h){return kt(Ie(n),a,i,h)}function Ut(a,n,i,h){return kt($r(n,a.length-i),a,i,h)}s.prototype.write=function(n,i,h,c){if(i===void 0)c="utf8",h=this.length,i=0;else if(h===void 0&&typeof i=="string")c=i,h=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(h)?(h=h>>>0,c===void 0&&(c="utf8")):(c=h,h=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var p=this.length-i;if((h===void 0||h>p)&&(h=p),n.length>0&&(h<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");for(var g=!1;;)switch(c){case"hex":return rt(this,n,i,h);case"utf8":case"utf-8":return Xt(this,n,i,h);case"ascii":case"latin1":case"binary":return St(this,n,i,h);case"base64":return zt(this,n,i,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ut(this,n,i,h);default:if(g)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),g=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ct(a,n,i){return n===0&&i===a.length?re.fromByteArray(a):re.fromByteArray(a.slice(n,i))}function lt(a,n,i){i=Math.min(a.length,i);for(var h=[],c=n;c<i;){var p=a[c],g=null,N=p>239?4:p>223?3:p>191?2:1;if(c+N<=i){var I,B,M,R;switch(N){case 1:p<128&&(g=p);break;case 2:I=a[c+1],(I&192)===128&&(R=(p&31)<<6|I&63,R>127&&(g=R));break;case 3:I=a[c+1],B=a[c+2],(I&192)===128&&(B&192)===128&&(R=(p&15)<<12|(I&63)<<6|B&63,R>2047&&(R<55296||R>57343)&&(g=R));break;case 4:I=a[c+1],B=a[c+2],M=a[c+3],(I&192)===128&&(B&192)===128&&(M&192)===128&&(R=(p&15)<<18|(I&63)<<12|(B&63)<<6|M&63,R>65535&&R<1114112&&(g=R))}}g===null?(g=65533,N=1):g>65535&&(g-=65536,h.push(g>>>10&1023|55296),g=56320|g&1023),h.push(g),c+=N}return Rt(h)}var nt=4096;function Rt(a){var n=a.length;if(n<=nt)return String.fromCharCode.apply(String,a);for(var i="",h=0;h<n;)i+=String.fromCharCode.apply(String,a.slice(h,h+=nt));return i}function pt(a,n,i){var h="";i=Math.min(a.length,i);for(var c=n;c<i;++c)h+=String.fromCharCode(a[c]&127);return h}function U(a,n,i){var h="";i=Math.min(a.length,i);for(var c=n;c<i;++c)h+=String.fromCharCode(a[c]);return h}function Y(a,n,i){var h=a.length;(!n||n<0)&&(n=0),(!i||i<0||i>h)&&(i=h);for(var c="",p=n;p<i;++p)c+=Cr[a[p]];return c}function O(a,n,i){for(var h=a.slice(n,i),c="",p=0;p<h.length-1;p+=2)c+=String.fromCharCode(h[p]+h[p+1]*256);return c}s.prototype.slice=function(n,i){var h=this.length;n=~~n,i=i===void 0?h:~~i,n<0?(n+=h,n<0&&(n=0)):n>h&&(n=h),i<0?(i+=h,i<0&&(i=0)):i>h&&(i=h),i<n&&(i=n);var c=this.subarray(n,i);return Object.setPrototypeOf(c,s.prototype),c};function S(a,n,i){if(a%1!==0||a<0)throw new RangeError("offset is not uint");if(a+n>i)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUintLE=s.prototype.readUIntLE=function(n,i,h){n=n>>>0,i=i>>>0,h||S(n,i,this.length);for(var c=this[n],p=1,g=0;++g<i&&(p*=256);)c+=this[n+g]*p;return c},s.prototype.readUintBE=s.prototype.readUIntBE=function(n,i,h){n=n>>>0,i=i>>>0,h||S(n,i,this.length);for(var c=this[n+--i],p=1;i>0&&(p*=256);)c+=this[n+--i]*p;return c},s.prototype.readUint8=s.prototype.readUInt8=function(n,i){return n=n>>>0,i||S(n,1,this.length),this[n]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(n,i){return n=n>>>0,i||S(n,2,this.length),this[n]|this[n+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(n,i){return n=n>>>0,i||S(n,2,this.length),this[n]<<8|this[n+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(n,i){return n=n>>>0,i||S(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(n,i){return n=n>>>0,i||S(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},s.prototype.readIntLE=function(n,i,h){n=n>>>0,i=i>>>0,h||S(n,i,this.length);for(var c=this[n],p=1,g=0;++g<i&&(p*=256);)c+=this[n+g]*p;return p*=128,c>=p&&(c-=Math.pow(2,8*i)),c},s.prototype.readIntBE=function(n,i,h){n=n>>>0,i=i>>>0,h||S(n,i,this.length);for(var c=i,p=1,g=this[n+--c];c>0&&(p*=256);)g+=this[n+--c]*p;return p*=128,g>=p&&(g-=Math.pow(2,8*i)),g},s.prototype.readInt8=function(n,i){return n=n>>>0,i||S(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},s.prototype.readInt16LE=function(n,i){n=n>>>0,i||S(n,2,this.length);var h=this[n]|this[n+1]<<8;return h&32768?h|4294901760:h},s.prototype.readInt16BE=function(n,i){n=n>>>0,i||S(n,2,this.length);var h=this[n+1]|this[n]<<8;return h&32768?h|4294901760:h},s.prototype.readInt32LE=function(n,i){return n=n>>>0,i||S(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},s.prototype.readInt32BE=function(n,i){return n=n>>>0,i||S(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},s.prototype.readFloatLE=function(n,i){return n=n>>>0,i||S(n,4,this.length),gt.read(this,n,!0,23,4)},s.prototype.readFloatBE=function(n,i){return n=n>>>0,i||S(n,4,this.length),gt.read(this,n,!1,23,4)},s.prototype.readDoubleLE=function(n,i){return n=n>>>0,i||S(n,8,this.length),gt.read(this,n,!0,52,8)},s.prototype.readDoubleBE=function(n,i){return n=n>>>0,i||S(n,8,this.length),gt.read(this,n,!1,52,8)};function C(a,n,i,h,c,p){if(!s.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>c||n<p)throw new RangeError('"value" argument is out of bounds');if(i+h>a.length)throw new RangeError("Index out of range")}s.prototype.writeUintLE=s.prototype.writeUIntLE=function(n,i,h,c){if(n=+n,i=i>>>0,h=h>>>0,!c){var p=Math.pow(2,8*h)-1;C(this,n,i,h,p,0)}var g=1,N=0;for(this[i]=n&255;++N<h&&(g*=256);)this[i+N]=n/g&255;return i+h},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(n,i,h,c){if(n=+n,i=i>>>0,h=h>>>0,!c){var p=Math.pow(2,8*h)-1;C(this,n,i,h,p,0)}var g=h-1,N=1;for(this[i+g]=n&255;--g>=0&&(N*=256);)this[i+g]=n/N&255;return i+h},s.prototype.writeUint8=s.prototype.writeUInt8=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,1,255,0),this[i]=n&255,i+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,2,65535,0),this[i]=n&255,this[i+1]=n>>>8,i+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,2,65535,0),this[i]=n>>>8,this[i+1]=n&255,i+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,4,4294967295,0),this[i+3]=n>>>24,this[i+2]=n>>>16,this[i+1]=n>>>8,this[i]=n&255,i+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,4,4294967295,0),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4},s.prototype.writeIntLE=function(n,i,h,c){if(n=+n,i=i>>>0,!c){var p=Math.pow(2,8*h-1);C(this,n,i,h,p-1,-p)}var g=0,N=1,I=0;for(this[i]=n&255;++g<h&&(N*=256);)n<0&&I===0&&this[i+g-1]!==0&&(I=1),this[i+g]=(n/N>>0)-I&255;return i+h},s.prototype.writeIntBE=function(n,i,h,c){if(n=+n,i=i>>>0,!c){var p=Math.pow(2,8*h-1);C(this,n,i,h,p-1,-p)}var g=h-1,N=1,I=0;for(this[i+g]=n&255;--g>=0&&(N*=256);)n<0&&I===0&&this[i+g+1]!==0&&(I=1),this[i+g]=(n/N>>0)-I&255;return i+h},s.prototype.writeInt8=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,1,127,-128),n<0&&(n=255+n+1),this[i]=n&255,i+1},s.prototype.writeInt16LE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,2,32767,-32768),this[i]=n&255,this[i+1]=n>>>8,i+2},s.prototype.writeInt16BE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,2,32767,-32768),this[i]=n>>>8,this[i+1]=n&255,i+2},s.prototype.writeInt32LE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,4,2147483647,-2147483648),this[i]=n&255,this[i+1]=n>>>8,this[i+2]=n>>>16,this[i+3]=n>>>24,i+4},s.prototype.writeInt32BE=function(n,i,h){return n=+n,i=i>>>0,h||C(this,n,i,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4};function Ae(a,n,i,h,c,p){if(i+h>a.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function Oe(a,n,i,h,c){return n=+n,i=i>>>0,c||Ae(a,n,i,4),gt.write(a,n,i,h,23,4),i+4}s.prototype.writeFloatLE=function(n,i,h){return Oe(this,n,i,!0,h)},s.prototype.writeFloatBE=function(n,i,h){return Oe(this,n,i,!1,h)};function Te(a,n,i,h,c){return n=+n,i=i>>>0,c||Ae(a,n,i,8),gt.write(a,n,i,h,52,8),i+8}s.prototype.writeDoubleLE=function(n,i,h){return Te(this,n,i,!0,h)},s.prototype.writeDoubleBE=function(n,i,h){return Te(this,n,i,!1,h)},s.prototype.copy=function(n,i,h,c){if(!s.isBuffer(n))throw new TypeError("argument should be a Buffer");if(h||(h=0),!c&&c!==0&&(c=this.length),i>=n.length&&(i=n.length),i||(i=0),c>0&&c<h&&(c=h),c===h||n.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(h<0||h>=this.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("sourceEnd out of bounds");c>this.length&&(c=this.length),n.length-i<c-h&&(c=n.length-i+h);var p=c-h;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,h,c):Uint8Array.prototype.set.call(n,this.subarray(h,c),i),p},s.prototype.fill=function(n,i,h,c){if(typeof n=="string"){if(typeof i=="string"?(c=i,i=0,h=this.length):typeof h=="string"&&(c=h,h=this.length),c!==void 0&&typeof c!="string")throw new TypeError("encoding must be a string");if(typeof c=="string"&&!s.isEncoding(c))throw new TypeError("Unknown encoding: "+c);if(n.length===1){var p=n.charCodeAt(0);(c==="utf8"&&p<128||c==="latin1")&&(n=p)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(i<0||this.length<i||this.length<h)throw new RangeError("Out of range index");if(h<=i)return this;i=i>>>0,h=h===void 0?this.length:h>>>0,n||(n=0);var g;if(typeof n=="number")for(g=i;g<h;++g)this[g]=n;else{var N=s.isBuffer(n)?n:s.from(n,c),I=N.length;if(I===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(g=0;g<h-i;++g)this[g+i]=N[g%I]}return this};var Dr=/[^+/0-9A-Za-z-_]/g;function Mr(a){if(a=a.split("=")[0],a=a.trim().replace(Dr,""),a.length<2)return"";for(;a.length%4!==0;)a=a+"=";return a}function Qt(a,n){n=n||1/0;for(var i,h=a.length,c=null,p=[],g=0;g<h;++g){if(i=a.charCodeAt(g),i>55295&&i<57344){if(!c){if(i>56319){(n-=3)>-1&&p.push(239,191,189);continue}else if(g+1===h){(n-=3)>-1&&p.push(239,191,189);continue}c=i;continue}if(i<56320){(n-=3)>-1&&p.push(239,191,189),c=i;continue}i=(c-55296<<10|i-56320)+65536}else c&&(n-=3)>-1&&p.push(239,191,189);if(c=null,i<128){if((n-=1)<0)break;p.push(i)}else if(i<2048){if((n-=2)<0)break;p.push(i>>6|192,i&63|128)}else if(i<65536){if((n-=3)<0)break;p.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((n-=4)<0)break;p.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return p}function Pr(a){for(var n=[],i=0;i<a.length;++i)n.push(a.charCodeAt(i)&255);return n}function $r(a,n){for(var i,h,c,p=[],g=0;g<a.length&&!((n-=2)<0);++g)i=a.charCodeAt(g),h=i>>8,c=i%256,p.push(c),p.push(h);return p}function Ie(a){return re.toByteArray(Mr(a))}function kt(a,n,i,h){for(var c=0;c<h&&!(c+i>=n.length||c>=a.length);++c)n[c+i]=a[c];return c}function z(a,n){return a instanceof n||a!=null&&a.constructor!=null&&a.constructor.name!=null&&a.constructor.name===n.name}function te(a){return a!==a}var Cr=function(){for(var a="0123456789abcdef",n=new Array(256),i=0;i<16;++i)for(var h=i*16,c=0;c<16;++c)n[h+c]=a[i]+a[c];return n}()}),T=Wt.Buffer;Wt.SlowBuffer;Wt.INSPECT_MAX_BYTES;Wt.kMaxLength;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var le=function(t,r){return le=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,f){o.__proto__=f}||function(o,f){for(var u in f)f.hasOwnProperty(u)&&(o[u]=f[u])},le(t,r)};function Ht(e,t){le(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var ft=function(e){Ht(t,e);function t(r){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),k=function(e){Ht(t,e);function t(r){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o}return Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function Lt(e){return e&&e.Math==Math&&e}function fr(){return Lt(typeof globalThis=="object"&&globalThis)||Lt(typeof window=="object"&&window)||Lt(typeof self=="object"&&self)||Lt(typeof global=="object"&&global)||Function("return this")()}function rn(){var e=fr();return typeof e.navigator=="object"&&e.navigator.product==="ReactNative"}var nn=function(t){var r=rn()?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var o=T.alloc(t),f=0;f<t;++f)o[f]=Math.floor(Math.random()*256);return o},on=function(){{if(typeof window<"u"){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(T.alloc(t))}}return typeof global<"u"&&global.crypto&&global.crypto.getRandomValues?function(t){return global.crypto.getRandomValues(T.alloc(t))}:nn}},ur=on();function sn(e){return["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(e))}function xe(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}function an(e){return Object.prototype.toString.call(e)==="[object RegExp]"}function fn(e){return Bt(e)&&Object.prototype.toString.call(e)==="[object Date]"}function Bt(e){return typeof e=="object"&&e!==null}function Gt(e,t){var r=!1;function o(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];return r||(console.warn(t),r=!0),e.apply(this,f)}return o}function $t(e){if(ArrayBuffer.isView(e))return T.from(e.buffer,e.byteOffset,e.byteLength);if(sn(e))return T.from(e);throw new k("Must use either Buffer or TypedArray")}var un=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,hr=function(e){return typeof e=="string"&&un.test(e)},pe=function(e){if(!hr(e))throw new k('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return T.from(t,"hex")},Re=function(e,t){return t===void 0&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},hn=Math.pow(2,53),cn=-Math.pow(2,53),cr=4,ut=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(t!=null&&typeof t!="string"&&!ArrayBuffer.isView(t)&&!(t instanceof ArrayBuffer)&&!Array.isArray(t))throw new k("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=r??e.BSON_BINARY_SUBTYPE_DEFAULT,t==null?(this.buffer=T.alloc(e.BUFFER_SIZE),this.position=0):(typeof t=="string"?this.buffer=T.from(t,"binary"):Array.isArray(t)?this.buffer=T.from(t):this.buffer=$t(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if(typeof t=="string"&&t.length!==1)throw new k("only accepts single character String");if(typeof t!="number"&&t.length!==1)throw new k("only accepts single character Uint8Array or Array");var r;if(typeof t=="string"?r=t.charCodeAt(0):typeof t=="number"?r=t:r=t[0],r<0||r>255)throw new k("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var o=T.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(o,0,0,this.buffer.length),this.buffer=o,this.buffer[this.position++]=r}},e.prototype.write=function(t,r){if(r=typeof r=="number"?r:this.position,this.buffer.length<r+t.length){var o=T.alloc(this.buffer.length+t.length);this.buffer.copy(o,0,0,this.buffer.length),this.buffer=o}ArrayBuffer.isView(t)?(this.buffer.set($t(t),r),this.position=r+t.byteLength>this.position?r+t.length:this.position):typeof t=="string"&&(this.buffer.write(t,r,t.length,"binary"),this.position=r+t.length>this.position?r+t.length:this.position)},e.prototype.read=function(t,r){return r=r&&r>0?r:this.position,this.buffer.slice(t,t+r)},e.prototype.value=function(t){return t=!!t,t&&this.buffer.length===this.position?this.buffer:t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(t){return this.buffer.toString(t)},e.prototype.toExtendedJSON=function(t){t=t||{};var r=this.buffer.toString("base64"),o=Number(this.sub_type).toString(16);return t.legacy?{$binary:r,$type:o.length===1?"0"+o:o}:{$binary:{base64:r,subType:o.length===1?"0"+o:o}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new ke(this.buffer.slice(0,this.position));throw new ft('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){r=r||{};var o,f;if("$binary"in t?r.legacy&&typeof t.$binary=="string"&&"$type"in t?(f=t.$type?parseInt(t.$type,16):0,o=T.from(t.$binary,"base64")):typeof t.$binary!="string"&&(f=t.$binary.subType?parseInt(t.$binary.subType,16):0,o=T.from(t.$binary.base64,"base64")):"$uuid"in t&&(f=4,o=pe(t.$uuid)),!o)throw new k("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return f===cr?new ke(o):new e(o,f)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.value(!0);return'new Binary(Buffer.from("'.concat(t.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(ut.prototype,"_bsontype",{value:"Binary"});var ne=16,ke=function(e){Ht(t,e);function t(r){var o=this,f,u;if(r==null)f=t.generate();else if(r instanceof t)f=T.from(r.buffer),u=r.__id;else if(ArrayBuffer.isView(r)&&r.byteLength===ne)f=$t(r);else if(typeof r=="string")f=pe(r);else throw new k("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");return o=e.call(this,f,cr)||this,o.__id=u,o}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(r){this.buffer=r,t.cacheHexString&&(this.__id=Re(r))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(r){if(r===void 0&&(r=!0),t.cacheHexString&&this.__id)return this.__id;var o=Re(this.id,r);return t.cacheHexString&&(this.__id=o),o},t.prototype.toString=function(r){return r?this.id.toString(r):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(r){if(!r)return!1;if(r instanceof t)return r.id.equals(this.id);try{return new t(r).id.equals(this.id)}catch{return!1}},t.prototype.toBinary=function(){return new ut(this.id,ut.SUBTYPE_UUID)},t.generate=function(){var r=ur(ne);return r[6]=r[6]&15|64,r[8]=r[8]&63|128,T.from(r)},t.isValid=function(r){return r?r instanceof t?!0:typeof r=="string"?hr(r):xe(r)?r.length!==ne?!1:(r[6]&240)===64&&(r[8]&128)===128:!1:!1},t.createFromHexString=function(r){var o=pe(r);return new t(o)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(ut),Zt=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toJSON();return'new Code("'.concat(String(t.code),'"').concat(t.scope?", ".concat(JSON.stringify(t.scope)):"",")")},e}();Object.defineProperty(Zt.prototype,"_bsontype",{value:"Code"});function ln(e){return Bt(e)&&e.$id!=null&&typeof e.$ref=="string"&&(e.$db==null||typeof e.$db=="string")}var At=function(){function e(t,r,o,f){if(!(this instanceof e))return new e(t,r,o,f);var u=t.split(".");u.length===2&&(o=u.shift(),t=u.shift()),this.collection=t,this.oid=r,this.db=o,this.fields=f||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(t){this.collection=t},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var t=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return this.db!=null&&(t.$db=this.db),t},e.prototype.toExtendedJSON=function(t){t=t||{};var r={$ref:this.collection,$id:this.oid};return t.legacy||(this.db&&(r.$db=this.db),r=Object.assign(r,this.fields)),r},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.oid===void 0||this.oid.toString===void 0?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(t),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(At.prototype,"_bsontype",{value:"DBRef"});var W=void 0;try{W=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}var Fe=65536,pn=1<<24,wt=Fe*Fe,lr=wt*wt,Le=lr/2,je={},De={},b=function(){function e(t,r,o){if(t===void 0&&(t=0),!(this instanceof e))return new e(t,r,o);typeof t=="bigint"?Object.assign(this,e.fromBigInt(t,!!r)):typeof t=="string"?Object.assign(this,e.fromString(t,!!r)):(this.low=t|0,this.high=r|0,this.unsigned=!!o),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,o){return new e(t,r,o)},e.fromInt=function(t,r){var o,f,u;return r?(t>>>=0,(u=0<=t&&t<256)&&(f=De[t],f)?f:(o=e.fromBits(t,(t|0)<0?-1:0,!0),u&&(De[t]=o),o)):(t|=0,(u=-128<=t&&t<128)&&(f=je[t],f)?f:(o=e.fromBits(t,t<0?-1:0,!1),u&&(je[t]=o),o))},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=lr)return e.MAX_UNSIGNED_VALUE}else{if(t<=-Le)return e.MIN_VALUE;if(t+1>=Le)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%wt|0,t/wt|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,o){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e.ZERO;if(typeof r=="number"?(o=r,r=!1):r=!!r,o=o||10,o<2||36<o)throw RangeError("radix");var f;if((f=t.indexOf("-"))>0)throw Error("interior hyphen");if(f===0)return e.fromString(t.substring(1),r,o).neg();for(var u=e.fromNumber(Math.pow(o,8)),s=e.ZERO,l=0;l<t.length;l+=8){var d=Math.min(8,t.length-l),w=parseInt(t.substring(l,l+d),o);if(d<8){var m=e.fromNumber(Math.pow(o,d));s=s.mul(m).add(e.fromNumber(w))}else s=s.mul(u),s=s.add(e.fromNumber(w))}return s.unsigned=r,s},e.fromBytes=function(t,r,o){return o?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(t){return Bt(t)&&t.__isLong__===!0},e.fromValue=function(t,r){return typeof t=="number"?e.fromNumber(t,r):typeof t=="string"?e.fromString(t,r):e.fromBits(t.low,t.high,typeof r=="boolean"?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,o=this.high&65535,f=this.low>>>16,u=this.low&65535,s=t.high>>>16,l=t.high&65535,d=t.low>>>16,w=t.low&65535,m=0,y=0,x=0,_=0;return _+=u+w,x+=_>>>16,_&=65535,x+=f+d,y+=x>>>16,x&=65535,y+=o+l,m+=y>>>16,y&=65535,m+=r+s,m&=65535,e.fromBits(x<<16|_,m<<16|y,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),o=t.isNegative();return r&&!o?-1:!r&&o?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(t){return this.compare(t)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(W){if(!this.unsigned&&this.high===-2147483648&&t.low===-1&&t.high===-1)return this;var r=(this.unsigned?W.div_u:W.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,W.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var o,f,u;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;u=e.UZERO}else{if(this.eq(e.MIN_VALUE)){if(t.eq(e.ONE)||t.eq(e.NEG_ONE))return e.MIN_VALUE;if(t.eq(e.MIN_VALUE))return e.ONE;var s=this.shr(1);return o=s.div(t).shl(1),o.eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(f=this.sub(t.mul(o)),u=o.add(f.div(t)),u)}else if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();u=e.ZERO}for(f=this;f.gte(t);){o=Math.max(1,Math.floor(f.toNumber()/t.toNumber()));for(var l=Math.ceil(Math.log(o)/Math.LN2),d=l<=48?1:Math.pow(2,l-48),w=e.fromNumber(o),m=w.mul(t);m.isNegative()||m.gt(f);)o-=d,w=e.fromNumber(o,this.unsigned),m=w.mul(t);w.isZero()&&(w=e.ONE),u=u.add(w),f=f.sub(m)}return u},e.prototype.div=function(t){return this.divide(t)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.unsigned!==t.unsigned&&this.high>>>31===1&&t.high>>>31===1?!1:this.high===t.high&&this.low===t.low},e.prototype.eq=function(t){return this.equals(t)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t=this.high!==0?this.high:this.low,r;for(r=31;r>0&&!(t&1<<r);r--);return this.high!==0?r+33:r+1},e.prototype.greaterThan=function(t){return this.comp(t)>0},e.prototype.gt=function(t){return this.greaterThan(t)},e.prototype.greaterThanOrEqual=function(t){return this.comp(t)>=0},e.prototype.gte=function(t){return this.greaterThanOrEqual(t)},e.prototype.ge=function(t){return this.greaterThanOrEqual(t)},e.prototype.isEven=function(){return(this.low&1)===0},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return(this.low&1)===1},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return this.high===0&&this.low===0},e.prototype.lessThan=function(t){return this.comp(t)<0},e.prototype.lt=function(t){return this.lessThan(t)},e.prototype.lessThanOrEqual=function(t){return this.comp(t)<=0},e.prototype.lte=function(t){return this.lessThanOrEqual(t)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),W){var r=(this.unsigned?W.rem_u:W.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,W.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(t){return this.modulo(t)},e.prototype.rem=function(t){return this.modulo(t)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),W){var r=W.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,W.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var o=this.high>>>16,f=this.high&65535,u=this.low>>>16,s=this.low&65535,l=t.high>>>16,d=t.high&65535,w=t.low>>>16,m=t.low&65535,y=0,x=0,_=0,v=0;return v+=s*m,_+=v>>>16,v&=65535,_+=u*m,x+=_>>>16,_&=65535,_+=s*w,x+=_>>>16,_&=65535,x+=f*m,y+=x>>>16,x&=65535,x+=u*w,y+=x>>>16,x&=65535,x+=s*d,y+=x>>>16,x&=65535,y+=o*m+f*w+u*d+s*l,y&=65535,e.fromBits(_<<16|v,y<<16|x,this.unsigned)},e.prototype.mul=function(t){return this.multiply(t)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(t){return!this.equals(t)},e.prototype.neq=function(t){return this.notEquals(t)},e.prototype.ne=function(t){return this.notEquals(t)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(t){return this.shiftLeft(t)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),(t&=63)===0?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(t){return this.shiftRight(t)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),t&=63,t===0)return this;var r=this.high;if(t<32){var o=this.low;return e.fromBits(o>>>t|r<<32-t,r>>>t,this.unsigned)}else return t===32?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(t){return this.shiftRightUnsigned(t)},e.prototype.shru=function(t){return this.shiftRightUnsigned(t)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(t){return this.subtract(t)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*wt+(this.low>>>0):this.high*wt+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var t=this.high,r=this.low;return[r&255,r>>>8&255,r>>>16&255,r>>>24,t&255,t>>>8&255,t>>>16&255,t>>>24]},e.prototype.toBytesBE=function(){var t=this.high,r=this.low;return[t>>>24,t>>>16&255,t>>>8&255,t&255,r>>>24,r>>>16&255,r>>>8&255,r&255]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if(t=t||10,t<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),o=this.div(r),f=o.mul(r).sub(this);return o.toString(t)+f.toInt().toString(t)}else return"-"+this.neg().toString(t);for(var u=e.fromNumber(Math.pow(t,6),this.unsigned),s=this,l="";;){var d=s.div(u),w=s.sub(d.mul(u)).toInt()>>>0,m=w.toString(t);if(s=d,s.isZero())return m+l;for(;m.length<6;)m="0"+m;l=""+m+l}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(t){return this.lessThanOrEqual(t)},e.prototype.toExtendedJSON=function(t){return t&&t.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var o=e.fromString(t.$numberLong);return r&&r.relaxed?o.toNumber():o},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(pn),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty(b.prototype,"__isLong__",{value:!0});Object.defineProperty(b.prototype,"_bsontype",{value:"Long"});var dn=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,gn=/^(\+|-)?(Infinity|inf)$/i,yn=/^(\+|-)?NaN$/i,_t=6111,ie=-6176,Me=6176,mn=34,oe=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Pe=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),$e=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),wn=/^([-+])?(\d+)?$/,xn=31,Ce=16383,bn=30,En=31;function Je(e){return!isNaN(parseInt(e,10))}function vn(e){var t=b.fromNumber(1e9),r=b.fromNumber(0);if(!e.parts[0]&&!e.parts[1]&&!e.parts[2]&&!e.parts[3])return{quotient:e,rem:r};for(var o=0;o<=3;o++)r=r.shiftLeft(32),r=r.add(new b(e.parts[o],0)),e.parts[o]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function Sn(e,t){if(!e&&!t)return{high:b.fromNumber(0),low:b.fromNumber(0)};var r=e.shiftRightUnsigned(32),o=new b(e.getLowBits(),0),f=t.shiftRightUnsigned(32),u=new b(t.getLowBits(),0),s=r.multiply(f),l=r.multiply(u),d=o.multiply(f),w=o.multiply(u);return s=s.add(l.shiftRightUnsigned(32)),l=new b(l.getLowBits(),0).add(d).add(w.shiftRightUnsigned(32)),s=s.add(l.shiftRightUnsigned(32)),w=l.shiftLeft(32).add(new b(w.getLowBits(),0)),{high:s,low:w}}function _n(e,t){var r=e.high>>>0,o=t.high>>>0;if(r<o)return!0;if(r===o){var f=e.low>>>0,u=t.low>>>0;if(f<u)return!0}return!1}function yt(e,t){throw new k('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var be=function(){function e(t){if(!(this instanceof e))return new e(t);if(typeof t=="string")this.bytes=e.fromString(t).bytes;else if(xe(t)){if(t.byteLength!==16)throw new k("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}else throw new k("Decimal128 must take a Buffer or string")}return e.fromString=function(t){var r=!1,o=!1,f=!1,u=0,s=0,l=0,d=0,w=0,m=[0],y=0,x=0,_=0,v=0,A=0,j=0,F=new b(0,0),L=new b(0,0),$=0,E=0;if(t.length>=7e3)throw new k(""+t+" not a valid Decimal128 string");var V=t.match(dn),X=t.match(gn),rt=t.match(yn);if(!V&&!X&&!rt||t.length===0)throw new k(""+t+" not a valid Decimal128 string");if(V){var Xt=V[2],St=V[4],zt=V[5],Ut=V[6];St&&Ut===void 0&&yt(t,"missing exponent power"),St&&Xt===void 0&&yt(t,"missing exponent base"),St===void 0&&(zt||Ut)&&yt(t,"missing e before exponent")}if((t[E]==="+"||t[E]==="-")&&(r=t[E++]==="-"),!Je(t[E])&&t[E]!=="."){if(t[E]==="i"||t[E]==="I")return new e(T.from(r?Pe:$e));if(t[E]==="N")return new e(T.from(oe))}for(;Je(t[E])||t[E]===".";){if(t[E]==="."){o&&yt(t,"contains multiple periods"),o=!0,E=E+1;continue}y<34&&(t[E]!=="0"||f)&&(f||(w=s),f=!0,m[x++]=parseInt(t[E],10),y=y+1),f&&(l=l+1),o&&(d=d+1),s=s+1,E=E+1}if(o&&!s)throw new k(""+t+" not a valid Decimal128 string");if(t[E]==="e"||t[E]==="E"){var ct=t.substr(++E).match(wn);if(!ct||!ct[2])return new e(T.from(oe));A=parseInt(ct[0],10),E=E+ct[0].length}if(t[E])return new e(T.from(oe));if(_=0,!y)_=0,v=0,m[0]=0,l=1,y=1,u=0;else if(v=y-1,u=l,u!==1)for(;m[w+u-1]===0;)u=u-1;for(A<=d&&d-A>16384?A=ie:A=A-d;A>_t;){if(v=v+1,v-_>mn){var lt=m.join("");if(lt.match(/^0+$/)){A=_t;break}yt(t,"overflow")}A=A-1}for(;A<ie||y<l;){if(v===0&&u<y){A=ie,u=0;break}if(y<l?l=l-1:v=v-1,A<_t)A=A+1;else{var lt=m.join("");if(lt.match(/^0+$/)){A=_t;break}yt(t,"overflow")}}if(v-_+1<u){var nt=s;o&&(w=w+1,nt=nt+1),r&&(w=w+1,nt=nt+1);var Rt=parseInt(t[w+v+1],10),pt=0;if(Rt>=5&&(pt=1,Rt===5)){for(pt=m[v]%2===1?1:0,j=w+v+2;j<nt;j++)if(parseInt(t[j],10)){pt=1;break}}if(pt){for(var U=v;U>=0;U--)if(++m[U]>9&&(m[U]=0,U===0))if(A<_t)A=A+1,m[U]=1;else return new e(T.from(r?Pe:$e))}}if(F=b.fromNumber(0),L=b.fromNumber(0),u===0)F=b.fromNumber(0),L=b.fromNumber(0);else if(v-_<17){var U=_;for(L=b.fromNumber(m[U++]),F=new b(0,0);U<=v;U++)L=L.multiply(b.fromNumber(10)),L=L.add(b.fromNumber(m[U]))}else{var U=_;for(F=b.fromNumber(m[U++]);U<=v-17;U++)F=F.multiply(b.fromNumber(10)),F=F.add(b.fromNumber(m[U]));for(L=b.fromNumber(m[U++]);U<=v;U++)L=L.multiply(b.fromNumber(10)),L=L.add(b.fromNumber(m[U]))}var Y=Sn(F,b.fromString("100000000000000000"));Y.low=Y.low.add(L),_n(Y.low,L)&&(Y.high=Y.high.add(b.fromNumber(1))),$=A+Me;var O={low:b.fromNumber(0),high:b.fromNumber(0)};Y.high.shiftRightUnsigned(49).and(b.fromNumber(1)).equals(b.fromNumber(1))?(O.high=O.high.or(b.fromNumber(3).shiftLeft(61)),O.high=O.high.or(b.fromNumber($).and(b.fromNumber(16383).shiftLeft(47))),O.high=O.high.or(Y.high.and(b.fromNumber(0x7fffffffffff)))):(O.high=O.high.or(b.fromNumber($&16383).shiftLeft(49)),O.high=O.high.or(Y.high.and(b.fromNumber(562949953421311)))),O.low=Y.low,r&&(O.high=O.high.or(b.fromString("9223372036854775808")));var S=T.alloc(16);return E=0,S[E++]=O.low.low&255,S[E++]=O.low.low>>8&255,S[E++]=O.low.low>>16&255,S[E++]=O.low.low>>24&255,S[E++]=O.low.high&255,S[E++]=O.low.high>>8&255,S[E++]=O.low.high>>16&255,S[E++]=O.low.high>>24&255,S[E++]=O.high.low&255,S[E++]=O.high.low>>8&255,S[E++]=O.high.low>>16&255,S[E++]=O.high.low>>24&255,S[E++]=O.high.high&255,S[E++]=O.high.high>>8&255,S[E++]=O.high.high>>16&255,S[E++]=O.high.high>>24&255,new e(S)},e.prototype.toString=function(){for(var t,r=0,o=new Array(36),f=0;f<o.length;f++)o[f]=0;var u=0,s=!1,l,d={parts:[0,0,0,0]},w,m,y=[];u=0;var x=this.bytes,_=x[u++]|x[u++]<<8|x[u++]<<16|x[u++]<<24,v=x[u++]|x[u++]<<8|x[u++]<<16|x[u++]<<24,A=x[u++]|x[u++]<<8|x[u++]<<16|x[u++]<<24,j=x[u++]|x[u++]<<8|x[u++]<<16|x[u++]<<24;u=0;var F={low:new b(_,v),high:new b(A,j)};F.high.lessThan(b.ZERO)&&y.push("-");var L=j>>26&xn;if(L>>3===3){if(L===bn)return y.join("")+"Infinity";if(L===En)return"NaN";t=j>>15&Ce,l=8+(j>>14&1)}else l=j>>14&7,t=j>>17&Ce;var $=t-Me;if(d.parts[0]=(j&16383)+((l&15)<<14),d.parts[1]=A,d.parts[2]=v,d.parts[3]=_,d.parts[0]===0&&d.parts[1]===0&&d.parts[2]===0&&d.parts[3]===0)s=!0;else for(m=3;m>=0;m--){var E=0,V=vn(d);if(d=V.quotient,E=V.rem.low,!!E)for(w=8;w>=0;w--)o[m*9+w]=E%10,E=Math.floor(E/10)}if(s)r=1,o[u]=0;else for(r=36;!o[u];)r=r-1,u=u+1;var X=r-1+$;if(X>=34||X<=-7||$>0){if(r>34)return y.push("".concat(0)),$>0?y.push("E+".concat($)):$<0&&y.push("E".concat($)),y.join("");y.push("".concat(o[u++])),r=r-1,r&&y.push(".");for(var f=0;f<r;f++)y.push("".concat(o[u++]));y.push("E"),X>0?y.push("+".concat(X)):y.push("".concat(X))}else if($>=0)for(var f=0;f<r;f++)y.push("".concat(o[u++]));else{var rt=r+$;if(rt>0)for(var f=0;f<rt;f++)y.push("".concat(o[u++]));else y.push("0");for(y.push(".");rt++<0;)y.push("0");for(var f=0;f<r-Math.max(rt-1,0);f++)y.push("".concat(o[u++]))}return y.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(be.prototype,"_bsontype",{value:"Decimal128"});var Yt=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toExtendedJSON=function(t){return t&&(t.legacy||t.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var o=parseFloat(t.$numberDouble);return r&&r.relaxed?o:new e(o)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var t=this.toExtendedJSON();return"new Double(".concat(t.$numberDouble,")")},e}();Object.defineProperty(Yt.prototype,"_bsontype",{value:"Double"});var qt=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t|0}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(t){return this.value.toString(t)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(t){return t&&(t.relaxed||t.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(qt.prototype,"_bsontype",{value:"Int32"});var Ee=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(Ee.prototype,"_bsontype",{value:"MaxKey"});var ve=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(ve.prototype,"_bsontype",{value:"MinKey"});var Nn=new RegExp("^[0-9a-fA-F]{24}$"),st=null,Q=Symbol("id"),J=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if(typeof t=="object"&&t&&"id"in t){if(typeof t.id!="string"&&!ArrayBuffer.isView(t.id))throw new k("Argument passed in must have an id that is of type string or Buffer");"toHexString"in t&&typeof t.toHexString=="function"?r=T.from(t.toHexString(),"hex"):r=t.id}else r=t;if(r==null||typeof r=="number")this[Q]=e.generate(typeof r=="number"?r:void 0);else if(ArrayBuffer.isView(r)&&r.byteLength===12)this[Q]=r instanceof T?r:$t(r);else if(typeof r=="string")if(r.length===12){var o=T.from(r);if(o.byteLength===12)this[Q]=o;else throw new k("Argument passed in must be a string of 12 bytes")}else if(r.length===24&&Nn.test(r))this[Q]=T.from(r,"hex");else throw new k("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");else throw new k("Argument passed in does not match the accepted types");e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[Q]},set:function(t){this[Q]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(t){this.id.writeUInt32BE(t,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){typeof t!="number"&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),o=T.alloc(12);return o.writeUInt32BE(t,0),st===null&&(st=ur(5)),o[4]=st[0],o[5]=st[1],o[6]=st[2],o[7]=st[3],o[8]=st[4],o[11]=r&255,o[10]=r>>8&255,o[9]=r>>16&255,o},e.prototype.toString=function(t){return t?this.id.toString(t):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(t==null)return!1;if(t instanceof e)return this[Q][11]===t[Q][11]&&this[Q].equals(t[Q]);if(typeof t=="string"&&e.isValid(t)&&t.length===12&&xe(this.id))return t===T.prototype.toString.call(this.id,"latin1");if(typeof t=="string"&&e.isValid(t)&&t.length===24)return t.toLowerCase()===this.toHexString();if(typeof t=="string"&&e.isValid(t)&&t.length===12)return T.from(t).equals(this.id);if(typeof t=="object"&&"toHexString"in t&&typeof t.toHexString=="function"){var r=t.toHexString(),o=this.toHexString().toLowerCase();return typeof r=="string"&&r.toLowerCase()===o}return!1},e.prototype.getTimestamp=function(){var t=new Date,r=this.id.readUInt32BE(0);return t.setTime(Math.floor(r)*1e3),t},e.createPk=function(){return new e},e.createFromTime=function(t){var r=T.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(typeof t>"u"||t!=null&&t.length!==24)throw new k("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(T.from(t,"hex"))},e.isValid=function(t){if(t==null)return!1;try{return new e(t),!0}catch{return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(Math.random()*16777215),e}();Object.defineProperty(J.prototype,"generate",{value:Gt(function(e){return J.generate(e)},"Please use the static `ObjectId.generate(time)` instead")});Object.defineProperty(J.prototype,"getInc",{value:Gt(function(){return J.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(J.prototype,"get_inc",{value:Gt(function(){return J.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(J,"get_inc",{value:Gt(function(){return J.getInc()},"Please use the static `ObjectId.getInc()` instead")});Object.defineProperty(J.prototype,"_bsontype",{value:"ObjectID"});function An(e){return e.split("").sort().join("")}var Ot=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=An(r??""),this.pattern.indexOf("\0")!==-1)throw new ft("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(this.options.indexOf("\0")!==-1)throw new ft("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var o=0;o<this.options.length;o++)if(!(this.options[o]==="i"||this.options[o]==="m"||this.options[o]==="x"||this.options[o]==="l"||this.options[o]==="s"||this.options[o]==="u"))throw new ft("The regular expression option [".concat(this.options[o],"] is not supported"))}return e.parseOptions=function(t){return t?t.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(t){return t=t||{},t.legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t)if(typeof t.$regex!="string"){if(t.$regex._bsontype==="BSONRegExp")return t}else return new e(t.$regex,e.parseOptions(t.$options));if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new k("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(Ot.prototype,"_bsontype",{value:"BSONRegExp"});var Se=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(Se.prototype,"_bsontype",{value:"Symbol"});var On=b,pr=function(e){Ht(t,e);function t(r,o){var f=this;return f instanceof t?(b.isLong(r)?f=e.call(this,r.low,r.high,!0)||this:Bt(r)&&typeof r.t<"u"&&typeof r.i<"u"?f=e.call(this,r.i,r.t,!0)||this:f=e.call(this,r,o,!0)||this,Object.defineProperty(f,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),f):new t(r,o)}return t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(r){return new t(b.fromInt(r,!0))},t.fromNumber=function(r){return new t(b.fromNumber(r,!0))},t.fromBits=function(r,o){return new t(r,o)},t.fromString=function(r,o){return new t(b.fromString(r,!0,o))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(r){return new t(r.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=b.MAX_UNSIGNED_VALUE,t}(On);function Tn(e){return Bt(e)&&Reflect.has(e,"_bsontype")&&typeof e._bsontype=="string"}var dr=2147483647,gr=-2147483648,yr=9223372036854776e3,mr=-9223372036854776e3,In={$oid:J,$binary:ut,$uuid:ut,$symbol:Se,$numberInt:qt,$numberDecimal:be,$numberDouble:Yt,$numberLong:b,$minKey:ve,$maxKey:Ee,$regex:Ot,$regularExpression:Ot,$timestamp:pr};function wr(e,t){if(t===void 0&&(t={}),typeof e=="number"){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=gr&&e<=dr)return new qt(e);if(e>=mr&&e<=yr)return b.fromNumber(e)}return new Yt(e)}if(e==null||typeof e!="object")return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(y){return y.startsWith("$")&&e[y]!=null}),o=0;o<r.length;o++){var f=In[r[o]];if(f)return f.fromExtendedJSON(e,t)}if(e.$date!=null){var u=e.$date,s=new Date;return t.legacy?typeof u=="number"?s.setTime(u):typeof u=="string"&&s.setTime(Date.parse(u)):typeof u=="string"?s.setTime(Date.parse(u)):b.isLong(u)?s.setTime(u.toNumber()):typeof u=="number"&&t.relaxed&&s.setTime(u),s}if(e.$code!=null){var l=Object.assign({},e);return e.$scope&&(l.$scope=wr(e.$scope)),Zt.fromExtendedJSON(e)}if(ln(e)||e.$dbPointer){var d=e.$ref?e:e.$dbPointer;if(d instanceof At)return d;var w=Object.keys(d).filter(function(y){return y.startsWith("$")}),m=!0;if(w.forEach(function(y){["$ref","$id","$db"].indexOf(y)===-1&&(m=!1)}),m)return At.fromExtendedJSON(d)}return e}function Bn(e,t){return e.map(function(r,o){t.seenObjects.push({propertyName:"index ".concat(o),obj:null});try{return it(r,t)}finally{t.seenObjects.pop()}})}function Ve(e){var t=e.toISOString();return e.getUTCMilliseconds()!==0?t:t.slice(0,-5)+"Z"}function it(e,t){if((typeof e=="object"||typeof e=="function")&&e!==null){var r=t.seenObjects.findIndex(function(F){return F.obj===e});if(r!==-1){var o=t.seenObjects.map(function(F){return F.propertyName}),f=o.slice(0,r).map(function(F){return"".concat(F," -> ")}).join(""),u=o[r],s=" -> "+o.slice(r+1,o.length-1).map(function(F){return"".concat(F," -> ")}).join(""),l=o[o.length-1],d=" ".repeat(f.length+u.length/2),w="-".repeat(s.length+(u.length+l.length)/2-1);throw new k(`Converting circular structure to EJSON:
`+"    ".concat(f).concat(u).concat(s).concat(l,`
`)+"    ".concat(d,"\\").concat(w,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return Bn(e,t);if(e===void 0)return null;if(e instanceof Date||fn(e)){var m=e.getTime(),y=m>-1&&m<2534023188e5;return t.legacy?t.relaxed&&y?{$date:e.getTime()}:{$date:Ve(e)}:t.relaxed&&y?{$date:Ve(e)}:{$date:{$numberLong:e.getTime().toString()}}}if(typeof e=="number"&&(!t.relaxed||!isFinite(e))){if(Math.floor(e)===e){var x=e>=gr&&e<=dr,_=e>=mr&&e<=yr;if(x)return{$numberInt:e.toString()};if(_)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||an(e)){var v=e.flags;if(v===void 0){var A=e.toString().match(/[gimuy]*$/);A&&(v=A[0])}var j=new Ot(e.source,v);return j.toExtendedJSON(t)}return e!=null&&typeof e=="object"?Rn(e,t):e}var Un={Binary:function(e){return new ut(e.value(),e.sub_type)},Code:function(e){return new Zt(e.code,e.scope)},DBRef:function(e){return new At(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new be(e.bytes)},Double:function(e){return new Yt(e.value)},Int32:function(e){return new qt(e.value)},Long:function(e){return b.fromBits(e.low!=null?e.low:e.low_,e.low!=null?e.high:e.high_,e.low!=null?e.unsigned:e.unsigned_)},MaxKey:function(){return new Ee},MinKey:function(){return new ve},ObjectID:function(e){return new J(e)},ObjectId:function(e){return new J(e)},BSONRegExp:function(e){return new Ot(e.pattern,e.options)},Symbol:function(e){return new Se(e.value)},Timestamp:function(e){return pr.fromBits(e.low,e.high)}};function Rn(e,t){if(e==null||typeof e!="object")throw new ft("not an object instance");var r=e._bsontype;if(typeof r>"u"){var o={};for(var f in e){t.seenObjects.push({propertyName:f,obj:null});try{var u=it(e[f],t);f==="__proto__"?Object.defineProperty(o,f,{value:u,writable:!0,enumerable:!0,configurable:!0}):o[f]=u}finally{t.seenObjects.pop()}}return o}else if(Tn(e)){var s=e;if(typeof s.toExtendedJSON!="function"){var l=Un[e._bsontype];if(!l)throw new k("Unrecognized or invalid _bsontype: "+e._bsontype);s=l(s)}return r==="Code"&&s.scope?s=new Zt(s.code,it(s.scope,t)):r==="DBRef"&&s.oid&&(s=new At(it(s.collection,t),it(s.oid,t),it(s.db,t),it(s.fields,t))),s.toExtendedJSON(t)}else throw new ft("_bsontype must be a string, but was: "+typeof r)}var ht;(function(e){function t(u,s){var l=Object.assign({},{relaxed:!0,legacy:!1},s);return typeof l.relaxed=="boolean"&&(l.strict=!l.relaxed),typeof l.strict=="boolean"&&(l.relaxed=!l.strict),JSON.parse(u,function(d,w){if(d.indexOf("\0")!==-1)throw new ft("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(d)));return wr(w,l)})}e.parse=t;function r(u,s,l,d){l!=null&&typeof l=="object"&&(d=l,l=0),s!=null&&typeof s=="object"&&!Array.isArray(s)&&(d=s,s=void 0,l=0);var w=Object.assign({relaxed:!0,legacy:!1},d,{seenObjects:[{propertyName:"(root)",obj:null}]}),m=it(u,w);return JSON.stringify(m,s,l)}e.stringify=r;function o(u,s){return s=s||{},JSON.parse(r(u,s))}e.serialize=o;function f(u,s){return s=s||{},t(JSON.stringify(u),s)}e.deserialize=f})(ht||(ht={}));var We=fr();We.Map?We.Map:function(){function e(t){t===void 0&&(t=[]),this._keys=[],this._values={};for(var r=0;r<t.length;r++)if(t[r]!=null){var o=t[r],f=o[0],u=o[1];this._keys.push(f),this._values[f]={v:u,i:this._keys.length-1}}}return e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(t){var r=this._values[t];return r==null?!1:(delete this._values[t],this._keys.splice(r.i,1),!0)},e.prototype.entries=function(){var t=this,r=0;return{next:function(){var o=t._keys[r++];return{value:o!==void 0?[o,t._values[o].v]:void 0,done:o===void 0}}}},e.prototype.forEach=function(t,r){r=r||this;for(var o=0;o<this._keys.length;o++){var f=this._keys[o];t.call(r,this._values[f].v,f,r)}},e.prototype.get=function(t){return this._values[t]?this._values[t].v:void 0},e.prototype.has=function(t){return this._values[t]!=null},e.prototype.keys=function(){var t=this,r=0;return{next:function(){var o=t._keys[r++];return{value:o!==void 0?o:void 0,done:o===void 0}}}},e.prototype.set=function(t,r){return this._values[t]?(this._values[t].v=r,this):(this._keys.push(t),this._values[t]={v:r,i:this._keys.length-1},this)},e.prototype.values=function(){var t=this,r=0;return{next:function(){var o=t._keys[r++];return{value:o!==void 0?t._values[o].v:void 0,done:o===void 0}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0}),e}();b.fromNumber(hn);b.fromNumber(cn);var se=new Uint8Array(8);new DataView(se.buffer,se.byteOffset,se.byteLength);var kn=1024*1024*17;T.alloc(kn);var He=function(e,t,r){if(r||arguments.length===2)for(var o=0,f=t.length,u;o<f;o++)(u||!(o in t))&&(u||(u=Array.prototype.slice.call(t,0,o)),u[o]=t[o]);return e.concat(u||Array.prototype.slice.call(t))},Fn=function(){function e(t,r,o){this.name=t,this.version=r,this.os=o,this.type="browser"}return e}(),Ln=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),jn=function(){function e(t,r,o,f){this.name=t,this.version=r,this.os=o,this.bot=f,this.type="bot-device"}return e}(),Dn=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Mn=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Pn=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,$n=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Ge=3,Cn=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Pn]],Ze=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function Jn(e){return e?Ye(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Mn:typeof navigator<"u"?Ye(navigator.userAgent):Hn()}function Vn(e){return e!==""&&Cn.reduce(function(t,r){var o=r[0],f=r[1];if(t)return t;var u=f.exec(e);return!!u&&[o,u]},!1)}function Ye(e){var t=Vn(e);if(!t)return null;var r=t[0],o=t[1];if(r==="searchbot")return new Dn;var f=o[1]&&o[1].split(".").join("_").split("_").slice(0,3);f?f.length<Ge&&(f=He(He([],f,!0),Gn(Ge-f.length),!0)):f=[];var u=f.join("."),s=Wn(e),l=$n.exec(e);return l&&l[1]?new jn(r,u,s,l[1]):new Fn(r,u,s)}function Wn(e){for(var t=0,r=Ze.length;t<r;t++){var o=Ze[t],f=o[0],u=o[1],s=u.exec(e);if(s)return f}return null}function Hn(){var e=typeof process<"u"&&process.version;return e?new Ln(process.version.slice(1)):null}function Gn(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}class et{constructor(){if(!et.fetch)throw new Error("DefaultNetworkTransport.fetch must be set before it's used");if(!et.AbortController)throw new Error("DefaultNetworkTransport.AbortController must be set before it's used")}fetchWithCallbacks(t,r){this.fetch(t).then(async o=>{const f=await o.text(),u={};return o.headers.forEach((s,l)=>{u[l]=s}),{statusCode:o.status,headers:u,body:f}}).then(o=>r.onSuccess(o)).catch(o=>r.onError(o))}async fetch(t){const{timeoutMs:r,url:o,...f}=t,{signal:u,cancelTimeout:s}=this.createTimeoutSignal(r);try{return await et.fetch(o,{...et.extraFetchOptions,signal:u,...f})}finally{s()}}createTimeoutSignal(t){if(typeof t=="number"){const r=new et.AbortController,o=setTimeout(()=>{r.abort()},t);return{signal:r.signal,cancelTimeout:()=>{clearTimeout(o)}}}else return{signal:void 0,cancelTimeout:()=>{}}}}et.DEFAULT_HEADERS={"Content-Type":"application/json"};const Zn=e=>{},jt=function(e){return e&&e.Math==Math&&e},Ct=jt(typeof globalThis=="object"&&globalThis)||jt(typeof window=="object"&&window)||jt(typeof self=="object"&&self)||jt(typeof global=="object"&&global)||function(){return this}()||Function("return this")();Zn(typeof __DEV__<"u"&&__DEV__);et.fetch=Ct.fetch.bind(Ct);et.AbortController=Ct.AbortController.bind(Ct);const xr="3.7.2",Yn=xr,qn=typeof atob=="function",Kn=typeof btoa=="function",vt=typeof Buffer=="function",qe=typeof TextDecoder=="function"?new TextDecoder:void 0,Ke=typeof TextEncoder=="function"?new TextEncoder:void 0,Xn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Nt=Array.prototype.slice.call(Xn),Dt=(e=>{let t={};return e.forEach((r,o)=>t[r]=o),t})(Nt),zn=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,D=String.fromCharCode.bind(String),Xe=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):(e,t=r=>r)=>new Uint8Array(Array.prototype.slice.call(e,0).map(t)),br=e=>e.replace(/=/g,"").replace(/[+\/]/g,t=>t=="+"?"-":"_"),Er=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),vr=e=>{let t,r,o,f,u="";const s=e.length%3;for(let l=0;l<e.length;){if((r=e.charCodeAt(l++))>255||(o=e.charCodeAt(l++))>255||(f=e.charCodeAt(l++))>255)throw new TypeError("invalid character found");t=r<<16|o<<8|f,u+=Nt[t>>18&63]+Nt[t>>12&63]+Nt[t>>6&63]+Nt[t&63]}return s?u.slice(0,s-3)+"===".substring(s):u},_e=Kn?e=>btoa(e):vt?e=>Buffer.from(e,"binary").toString("base64"):vr,de=vt?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let o=0,f=e.length;o<f;o+=4096)r.push(D.apply(null,e.subarray(o,o+4096)));return _e(r.join(""))},Pt=(e,t=!1)=>t?br(de(e)):de(e),Qn=e=>{if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?D(192|t>>>6)+D(128|t&63):D(224|t>>>12&15)+D(128|t>>>6&63)+D(128|t&63)}else{var t=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return D(240|t>>>18&7)+D(128|t>>>12&63)+D(128|t>>>6&63)+D(128|t&63)}},ti=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Sr=e=>e.replace(ti,Qn),ze=vt?e=>Buffer.from(e,"utf8").toString("base64"):Ke?e=>de(Ke.encode(e)):e=>_e(Sr(e)),bt=(e,t=!1)=>t?br(ze(e)):ze(e),Qe=e=>bt(e,!0),ei=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,ri=e=>{switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),r=t-65536;return D((r>>>10)+55296)+D((r&1023)+56320);case 3:return D((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return D((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},_r=e=>e.replace(ei,ri),Nr=e=>{if(e=e.replace(/\s+/g,""),!zn.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(e.length&3));let t,r="",o,f;for(let u=0;u<e.length;)t=Dt[e.charAt(u++)]<<18|Dt[e.charAt(u++)]<<12|(o=Dt[e.charAt(u++)])<<6|(f=Dt[e.charAt(u++)]),r+=o===64?D(t>>16&255):f===64?D(t>>16&255,t>>8&255):D(t>>16&255,t>>8&255,t&255);return r},Ne=qn?e=>atob(Er(e)):vt?e=>Buffer.from(e,"base64").toString("binary"):Nr,Ar=vt?e=>Xe(Buffer.from(e,"base64")):e=>Xe(Ne(e),t=>t.charCodeAt(0)),Or=e=>Ar(Tr(e)),ni=vt?e=>Buffer.from(e,"base64").toString("utf8"):qe?e=>qe.decode(Ar(e)):e=>_r(Ne(e)),Tr=e=>Er(e.replace(/[-_]/g,t=>t=="-"?"+":"/")),ge=e=>ni(Tr(e)),ii=e=>{if(typeof e!="string")return!1;const t=e.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test(t)||!/[^\s0-9a-zA-Z\-_]/.test(t)},Ir=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),Br=function(){const e=(t,r)=>Object.defineProperty(String.prototype,t,Ir(r));e("fromBase64",function(){return ge(this)}),e("toBase64",function(t){return bt(this,t)}),e("toBase64URI",function(){return bt(this,!0)}),e("toBase64URL",function(){return bt(this,!0)}),e("toUint8Array",function(){return Or(this)})},Ur=function(){const e=(t,r)=>Object.defineProperty(Uint8Array.prototype,t,Ir(r));e("toBase64",function(t){return Pt(this,t)}),e("toBase64URI",function(){return Pt(this,!0)}),e("toBase64URL",function(){return Pt(this,!0)})},oi=()=>{Br(),Ur()},Jt={version:xr,VERSION:Yn,atob:Ne,atobPolyfill:Nr,btoa:_e,btoaPolyfill:vr,fromBase64:ge,toBase64:bt,encode:bt,encodeURI:Qe,encodeURL:Qe,utob:Sr,btou:_r,decode:ge,isValid:ii,fromUint8Array:Pt,toUint8Array:Or,extendString:Br,extendUint8Array:Ur,extendBuiltins:oi},si={relaxed:!1};function Rr(e){return ht.serialize(e,si)}function kr(e){return Array.isArray(e)?e.map(t=>ht.deserialize(t)):ht.deserialize(e)}var ye;(function(e){e.Normal="normal",e.Server="server"})(ye||(ye={}));var q;(function(e){e.NAME="name",e.EMAIL="email",e.PICTURE="picture",e.FIRST_NAME="first_name",e.LAST_NAME="last_name",e.GENDER="gender",e.BIRTHDAY="birthday",e.MIN_AGE="min_age",e.MAX_AGE="max_age"})(q||(q={}));const tr={[q.NAME]:"name",[q.EMAIL]:"email",[q.PICTURE]:"pictureUrl",[q.FIRST_NAME]:"firstName",[q.LAST_NAME]:"lastName",[q.GENDER]:"gender",[q.BIRTHDAY]:"birthday",[q.MIN_AGE]:"minAge",[q.MAX_AGE]:"maxAge"};class Fr{constructor(t){if(this.type=ye.Normal,this.identities=[],typeof t=="object"&&t!==null){const{type:r,identities:o,data:f}=t;if(typeof r=="string")this.type=r;else throw new Error("Expected 'type' in the response body");if(Array.isArray(o))this.identities=o.map(u=>{const{id:s,provider_type:l}=u;return{id:s,providerType:l}});else throw new Error("Expected 'identities' in the response body");if(typeof f=="object"&&f!==null){const u=Object.fromEntries(Object.entries(f).map(([s,l])=>s in tr?[tr[s],l]:[s,l]));this.data=kr(u)}else throw new Error("Expected 'data' in the response body")}else this.data={}}}class K{constructor(t,r){this.storage=t,this.keyPart=r}get(t){return this.storage.get(this.keyPart+K.PART_SEPARATOR+t)}set(t,r){return this.storage.set(this.keyPart+K.PART_SEPARATOR+t,r)}remove(t){return this.storage.remove(this.keyPart+K.PART_SEPARATOR+t)}prefix(t){return new K(this,t)}clear(t=""){return this.storage.clear(this.keyPart+K.PART_SEPARATOR+t)}addListener(t){return this.storage.addListener(t)}removeListener(t){return this.storage.addListener(t)}}K.PART_SEPARATOR=":";class ai{constructor(){this.storage={},this.listeners=new Set}get(t){return t in this.storage?this.storage[t]:null}set(t,r){this.storage[t]=r,this.fireListeners()}remove(t){delete this.storage[t],this.fireListeners()}prefix(t){return new K(this,t)}clear(t){for(const r of Object.keys(this.storage))(!t||r.startsWith(t))&&delete this.storage[r];this.fireListeners()}addListener(t){this.listeners.add(t)}removeListener(t){this.listeners.delete(t)}fireListeners(){this.listeners.forEach(t=>t())}}const ae="accessToken",fe="refreshToken",ue="profile",he="providerType";class fi extends K{constructor(t,r){super(t,`user(${r})`)}get accessToken(){return this.get(ae)}set accessToken(t){t===null?this.remove(ae):this.set(ae,t)}get refreshToken(){return this.get(fe)}set refreshToken(t){t===null?this.remove(fe):this.set(fe,t)}get profile(){const t=this.get(ue);if(t){const r=new Fr;return Object.assign(r,JSON.parse(t)),r}}set profile(t){t?this.set(ue,JSON.stringify(t)):this.remove(ue)}get providerType(){const t=this.get(he);if(t)return t}set providerType(t){t?this.set(he,t):this.remove(he)}}function me(e){return Object.fromEntries(Object.entries(e).filter(t=>typeof t[1]<"u"))}function ui(e,t){let r="";for(let o=0;o<e;o++)r+=t[Math.floor(Math.random()*t.length)];return r}function Lr(e,t=!0){const r=me(e);return(t&&Object.keys(r).length>0?"?":"")+Object.entries(r).map(([f,u])=>`${f}=${encodeURIComponent(u)}`).join("&")}function hi(e){const t=e[0]==="?"?e.substr(1):e;return Object.fromEntries(t.split("&").filter(r=>r.length>0).map(r=>r.split("=")).map(([r,o])=>[r,decodeURIComponent(o)]))}const ci=["inspect","callFunction","callFunctionStreaming",...Object.getOwnPropertyNames(Object.prototype)];function li(e){for(const t of e)if(typeof t=="object"&&t)for(const[r,o]of Object.entries(t))o===void 0&&delete t[r];return e}function pi(e){return li(e).map(r=>typeof r=="object"?Rr(r):r)}class Kt{constructor(t,r={}){this.fetcher=t,this.serviceName=r.serviceName,this.argsTransformation=r.argsTransformation||pi}static create(t,r={}){const o=new Kt(t,r);return new Proxy(o,{get(f,u,s){if(typeof u=="string"&&ci.indexOf(u)===-1)return f.callFunction.bind(f,u);{const l=Reflect.get(f,u,s);return typeof l=="function"?l.bind(f):l}}})}async callFunction(t,...r){const o={name:t,arguments:this.argsTransformation?this.argsTransformation(r):r};this.serviceName&&(o.service=this.serviceName);const f=this.fetcher.appRoute;return this.fetcher.fetchJSON({method:"POST",path:f.functionsCall().path,body:o})}callFunctionStreaming(t,...r){const o={name:t,arguments:this.argsTransformation?this.argsTransformation(r):r};this.serviceName&&(o.service=this.serviceName);const f=this.fetcher.appRoute,u=Lr({baas_request:Jt.encode(JSON.stringify(o))});return this.fetcher.fetchStream({method:"GET",path:f.functionsCall().path+u})}}class di{constructor(t,r="local-userpass"){this.fetcher=t,this.providerName=r}async registerUser(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).register().path,body:t})}async confirmUser(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirm().path,body:t})}async resendConfirmationEmail(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirmSend().path,body:t})}async retryCustomConfirmation(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).confirmCall().path,body:t})}async resetPassword(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).reset().path,body:t})}async sendResetPasswordEmail(t){const r=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:r.emailPasswordAuth(this.providerName).resetSend().path,body:t})}async callResetPasswordFunction(t,...r){const o=this.fetcher.appRoute;await this.fetcher.fetchJSON({method:"POST",path:o.emailPasswordAuth(this.providerName).resetCall().path,body:{...t,arguments:r}})}}function gi(){return{path:"/api/client/v2.0",app(e){return{path:this.path+`/app/${e}`,location(){return{path:this.path+"/location"}},authProvider(t){return{path:this.path+`/auth/providers/${t}`,login(){return{path:this.path+"/login"}}}},emailPasswordAuth(t){return{...this.authProvider(t),register(){return{path:this.path+"/register"}},confirm(){return{path:this.path+"/confirm"}},confirmSend(){return{path:this.path+"/confirm/send"}},confirmCall(){return{path:this.path+"/confirm/call"}},reset(){return{path:this.path+"/reset"}},resetSend(){return{path:this.path+"/reset/send"}},resetCall(){return{path:this.path+"/reset/call"}}}},functionsCall(){return{path:this.path+"/functions/call"}}}},auth(){return{path:this.path+"/auth",apiKeys(){return{path:this.path+"/api_keys",key(e){return{path:this.path+`/${e}`,enable(){return{path:this.path+"/enable"}},disable(){return{path:this.path+"/disable"}}}}}},profile(){return{path:this.path+"/profile"}},session(){return{path:this.path+"/session"}},delete(){return{path:this.path+"/delete"}}}}}}var Z={api:gi};class yi{constructor(t){this.fetcher=t}create(t){return this.fetcher.fetchJSON({method:"POST",body:{name:t},path:Z.api().auth().apiKeys().path,tokenType:"refresh"})}fetch(t){return this.fetcher.fetchJSON({method:"GET",path:Z.api().auth().apiKeys().key(t).path,tokenType:"refresh"})}fetchAll(){return this.fetcher.fetchJSON({method:"GET",tokenType:"refresh",path:Z.api().auth().apiKeys().path})}async delete(t){await this.fetcher.fetchJSON({method:"DELETE",path:Z.api().auth().apiKeys().key(t).path,tokenType:"refresh"})}async enable(t){await this.fetcher.fetchJSON({method:"PUT",path:Z.api().auth().apiKeys().key(t).enable().path,tokenType:"refresh"})}async disable(t){await this.fetcher.fetchJSON({method:"PUT",path:Z.api().auth().apiKeys().key(t).disable().path,tokenType:"refresh"})}}let we=null;function mi(e){we=e}function Tt(){if(we)return we;throw new Error("Cannot get environment before it's set")}class ce extends Error{constructor({message:t,code:r}){super(t),this.name="WatchError",this.code=r}}var P;(function(e){e.NEED_DATA="NEED_DATA",e.HAVE_EVENT="HAVE_EVENT",e.HAVE_ERROR="HAVE_ERROR"})(P||(P={}));class wi{constructor(){this._state=P.NEED_DATA,this._error=null,this._textDecoder=new(Tt()).TextDecoder,this._buffer="",this._bufferOffset=0,this._eventType="",this._dataBuffer=""}feedBuffer(t){this.assertState(P.NEED_DATA),this._buffer+=this._textDecoder.decode(t,{stream:!0}),this.advanceBufferState()}feedLine(t){if(this.assertState(P.NEED_DATA),t.endsWith(`
`)&&(t=t.substr(0,t.length-1)),t.endsWith("\r")&&(t=t.substr(0,t.length-1)),t.length===0){if(this._dataBuffer.length===0){this._eventType="";return}this._dataBuffer.endsWith(`
`)&&(this._dataBuffer=this._dataBuffer.substr(0,this._dataBuffer.length-1)),this.feedSse({data:this._dataBuffer,eventType:this._eventType}),this._dataBuffer="",this._eventType=""}if(t[0]===":")return;const r=t.indexOf(":"),o=t.substr(0,r);let f=r===-1?"":t.substr(r+1);f.startsWith(" ")&&(f=f.substr(1)),o==="event"?this._eventType=f:o==="data"&&(this._dataBuffer+=f,this._dataBuffer+=`
`)}feedSse(t){this.assertState(P.NEED_DATA);const r=t.data.indexOf("%");if(r!==-1){let o="",f=0;for(let u=r;u!==-1;u=t.data.indexOf("%",f)){o+=t.data.substr(f,u-f);const s=t.data.substr(u,3);s==="%25"?o+="%":s==="%0A"?o+=`
`:s==="%0D"?o+="\r":o+=s,f=u+s.length}o+=t.data.substr(f),t.data=o}if(!t.eventType||t.eventType==="message"){try{const o=ht.parse(t.data);if(typeof o=="object"){this._nextEvent=o,this._state=P.HAVE_EVENT;return}}catch{}this._state=P.HAVE_ERROR,this._error=new ce({message:"server returned malformed event: "+t.data,code:"bad bson parse"})}else if(t.eventType==="error"){this._state=P.HAVE_ERROR,this._error=new ce({message:t.data,code:"unknown"});try{const{error_code:o,error:f}=ht.parse(t.data);if(typeof o!="string"||typeof f!="string")return;this._error=new ce({message:f,code:o})}catch{return}}}get state(){return this._state}nextEvent(){this.assertState(P.HAVE_EVENT);const t=this._nextEvent;return this._state=P.NEED_DATA,this.advanceBufferState(),t}get error(){return this._error}advanceBufferState(){for(this.assertState(P.NEED_DATA);this.state===P.NEED_DATA;){if(this._bufferOffset===this._buffer.length){this._buffer="",this._bufferOffset=0;return}const t=this._buffer.indexOf(`
`,this._bufferOffset);if(t===-1){this._bufferOffset!==0&&(this._buffer=this._buffer.substr(this._bufferOffset,this._buffer.length-this._bufferOffset),this._bufferOffset=0);return}this.feedLine(this._buffer.substr(this._bufferOffset,t-this._bufferOffset)),this._bufferOffset=t+1}}assertState(t){if(this._state!==t)throw Error(`Expected WatchStream to be in state ${t}, but in state ${this._state}`)}}class xi{constructor(t,r,o,f){this.functions=Kt.create(t,{serviceName:r}),this.databaseName=o,this.collectionName=f,this.serviceName=r,this.fetcher=t}find(t={},r={}){return this.functions.find({database:this.databaseName,collection:this.collectionName,query:t,project:r.projection,sort:r.sort,limit:r.limit})}findOne(t={},r={}){return this.functions.findOne({database:this.databaseName,collection:this.collectionName,query:t,project:r.projection,sort:r.sort})}findOneAndUpdate(t={},r,o={}){return this.functions.findOneAndUpdate({database:this.databaseName,collection:this.collectionName,filter:t,update:r,sort:o.sort,projection:o.projection,upsert:o.upsert,returnNewDocument:o.returnNewDocument})}findOneAndReplace(t={},r,o={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,update:r,sort:o.sort,projection:o.projection,upsert:o.upsert,returnNewDocument:o.returnNewDocument})}findOneAndDelete(t={},r={}){return this.functions.findOneAndReplace({database:this.databaseName,collection:this.collectionName,filter:t,sort:r.sort,projection:r.projection})}aggregate(t){return this.functions.aggregate({database:this.databaseName,collection:this.collectionName,pipeline:t})}count(t={},r={}){return this.functions.count({database:this.databaseName,collection:this.collectionName,query:t,limit:r.limit})}insertOne(t){return this.functions.insertOne({database:this.databaseName,collection:this.collectionName,document:t})}insertMany(t){return this.functions.insertMany({database:this.databaseName,collection:this.collectionName,documents:t})}deleteOne(t={}){return this.functions.deleteOne({database:this.databaseName,collection:this.collectionName,query:t})}deleteMany(t={}){return this.functions.deleteMany({database:this.databaseName,collection:this.collectionName,query:t})}updateOne(t,r,o={}){return this.functions.updateOne({database:this.databaseName,collection:this.collectionName,query:t,update:r,upsert:o.upsert,arrayFilters:o.arrayFilters})}updateMany(t,r,o={}){return this.functions.updateMany({database:this.databaseName,collection:this.collectionName,query:t,update:r,upsert:o.upsert,arrayFilters:o.arrayFilters})}watch({ids:t,filter:r}={}){const f=this.functions.callFunctionStreaming("watch",{database:this.databaseName,collection:this.collectionName,ids:t,filter:r}).then(l=>l[Symbol.asyncIterator]()),u=this.watchImpl(f),s=u.return;return Object.assign(u,{return(l){return f.then(d=>d.return?d.return(l):void 0),s.call(u,l)}})}async*watchImpl(t){const r=new wi,o=t.then(f=>({[Symbol.asyncIterator]:()=>f}));for await(const f of await o)if(f){for(r.feedBuffer(f);r.state==P.HAVE_EVENT;)yield r.nextEvent();if(r.state==P.HAVE_ERROR)throw r.error}}}function bi(e,t,r,o){return new xi(e,t,r,o)}function Ei(e,t,r){return{collection:bi.bind(null,e,t,r)}}function vi(e,t="mongo-db"){return{db:Ei.bind(null,e,t)}}const Si="000000000000000000000000";var at;(function(e){e.Active="active",e.LoggedOut="logged-out",e.Removed="removed"})(at||(at={}));var er;(function(e){e.Normal="normal",e.Server="server"})(er||(er={}));class rr{constructor(t){if(this.app=t.app,this.id=t.id,this.storage=new fi(this.app.storage,this.id),"accessToken"in t&&"refreshToken"in t&&"providerType"in t)this._accessToken=t.accessToken,this._refreshToken=t.refreshToken,this.providerType=t.providerType,this.storage.accessToken=t.accessToken,this.storage.refreshToken=t.refreshToken,this.storage.providerType=t.providerType;else{this._accessToken=this.storage.accessToken,this._refreshToken=this.storage.refreshToken;const r=this.storage.providerType;if(this._profile=this.storage.profile,r)this.providerType=r;else throw new Error("Storage is missing a provider type")}this.fetcher=this.app.fetcher.clone({userContext:{currentUser:this}}),this.apiKeys=new yi(this.fetcher),this.functions=Kt.create(this.fetcher)}get accessToken(){return this._accessToken}set accessToken(t){this._accessToken=t,this.storage.accessToken=t}get refreshToken(){return this._refreshToken}set refreshToken(t){this._refreshToken=t,this.storage.refreshToken=t}get state(){return this.id in this.app.allUsers?this.refreshToken===null?at.LoggedOut:at.Active:at.Removed}get isLoggedIn(){return this.state===at.Active}get customData(){if(this.accessToken)return this.decodeAccessToken().userData;throw new Error("Cannot read custom data without an access token")}get profile(){if(this._profile)return this._profile.data;throw new Error("A profile was never fetched for this user")}get identities(){if(this._profile)return this._profile.identities;throw new Error("A profile was never fetched for this user")}get deviceId(){if(this.accessToken){const t=this.accessToken.split(".")[1];if(t){const o=JSON.parse(Jt.decode(t)).baas_device_id;if(typeof o=="string"&&o!==Si)return o}}return null}async refreshProfile(){const t=await this.fetcher.fetchJSON({method:"GET",path:Z.api().auth().profile().path});this._profile=new Fr(t),this.storage.profile=this._profile}async logOut(){try{this._refreshToken!==null&&await this.fetcher.fetchJSON({method:"DELETE",path:Z.api().auth().session().path,tokenType:"refresh"})}catch(t){if(!(t instanceof Error)||!t.message.includes("failed to find refresh token"))throw t}finally{this.accessToken=null,this.refreshToken=null}}async linkCredentials(t){const r=await this.app.authenticator.authenticate(t,this);if(this.id!==r.userId){const o=`got user id ${r.userId} expected ${this.id}`;throw new Error(`Link response ment for another user (${o})`)}this.accessToken=r.accessToken,await this.refreshProfile()}async refreshAccessToken(){const t=await this.fetcher.fetchJSON({method:"POST",path:Z.api().auth().session().path,tokenType:"refresh"}),{access_token:r}=t;if(typeof r=="string")this.accessToken=r;else throw new Error("Expected an 'access_token' in the response")}async refreshCustomData(){return await this.refreshAccessToken(),this.customData}addListener(){throw new Error("Not yet implemented")}removeListener(){throw new Error("Not yet implemented")}removeAllListeners(){throw new Error("Not yet implemented")}callFunction(t,...r){return this.functions.callFunction(t,...r)}toJSON(){return{id:this.id,accessToken:this.accessToken,refreshToken:this.refreshToken,profile:this._profile,state:this.state,customData:this.customData}}push(){throw new Error("Not yet implemented")}mongoClient(t){return vi(this.fetcher,t)}decodeAccessToken(){if(this.accessToken){const t=this.accessToken.split(".");if(t.length!==3)throw new Error("Expected an access token with three parts");const r=t[1],o=Jt.decode(r),f=JSON.parse(o),{exp:u,iat:s,sub:l,user_data:d={}}=f;if(typeof u!="number")throw new Error("Failed to decode access token 'exp'");if(typeof s!="number")throw new Error("Failed to decode access token 'iat'");return{expires:u,issuedAt:s,subject:l,userData:d}}else throw new Error("Missing an access token")}}class G{constructor(t,r,o){this.providerName=t,this.providerType=r,this.payload=o}static anonymous(){return new G("anon-user","anon-user",{})}static apiKey(t){return new G("api-key","api-key",{key:t})}static emailPassword(t,r){return new G("local-userpass","local-userpass",{username:t,password:r})}static function(t){return new G("custom-function","custom-function",t)}static jwt(t){return new G("custom-token","custom-token",{token:t})}static google(t){return new G("oauth2-google","oauth2-google",G.derivePayload(t))}static derivePayload(t){if(typeof t=="string")throw new Error("`google(<tokenString>)` has been deprecated.  Please use `google(<authCodeObject>).");if(Object.keys(t).length===1){if("authCode"in t||"redirectUrl"in t)return t;if("idToken"in t)return{id_token:t.idToken};throw new Error("Unexpected payload: "+JSON.stringify(t))}else throw new Error("Expected only one property in payload, got "+JSON.stringify(t))}static facebook(t){return new G("oauth2-facebook","oauth2-facebook",t.includes("://")?{redirectUrl:t}:{accessToken:t})}static apple(t){return new G("oauth2-apple","oauth2-apple",t.includes("://")?{redirectUrl:t}:{id_token:t})}}const nr="userIds",ir="deviceId";class _i extends K{constructor(t,r){super(t,`app(${r})`)}getUserIds(){const t=this.get(nr),r=t?JSON.parse(t):[];if(Array.isArray(r))return[...new Set(r)];throw new Error("Expected the user ids to be an array")}setUserIds(t,r){if(r){const o=this.getUserIds();for(const f of o)t.indexOf(f)===-1&&t.push(f)}this.set(nr,JSON.stringify(t))}removeUserId(t){const o=this.getUserIds().filter(f=>f!==t);this.setUserIds(o,!1)}getDeviceId(){return this.get(ir)}setDeviceId(t){this.set(ir,t)}}const Ni="abcdefghijklmnopqrstuvwxyz",Ai=100,Oi={_stitch_client_app_id:"appId",_baas_client_app_id:"appId",_stitch_ua:"userAuth",_baas_ua:"userAuth",_stitch_link:"link",_baas_link:"link",_stitch_error:"error",_baas_error:"error",_stitch_state:"state",_baas_state:"state"};class Et{constructor(t,r=Tt().openWindow){this.storage=t.prefix("oauth2"),this.openWindow=r}static parseRedirectLocation(t){const r=hi(t),o={};for(const[f,u]of Object.entries(Oi)){const s=r[f];s&&(o[u]=s)}return o}static handleRedirect(t,r=Tt().defaultStorage){const o=Et.parseRedirectLocation(t),{state:f,error:u}=o;if(typeof f=="string"){const s=r.prefix("oauth2");Et.getStateStorage(s,f).set("result",JSON.stringify(o))}else throw u?new Error(`Failed to handle OAuth 2.0 redirect: ${u}`):new Error("Failed to handle OAuth 2.0 redirect.")}static decodeAuthInfo(t){const r=(t||"").split("$");if(r.length===4){const[o,f,u,s]=r;return{accessToken:o,refreshToken:f,userId:u,deviceId:s}}else throw new Error("Failed to decode 'authInfo' into ids and tokens")}static getStateStorage(t,r){return t.prefix(`state(${r})`)}openWindowAndWaitForRedirect(t,r){const o=Et.getStateStorage(this.storage,r);return new Promise((f,u)=>{let s=null,l;const d=()=>{const w=o.get("result");if(w){const m=JSON.parse(w);o.removeListener(d),o.clear();try{s&&(clearInterval(l),s.close())}catch(y){console.warn(`Failed closing redirect window: ${y}`)}finally{f(m)}}};o.addListener(d),s=this.openWindow(t),l=setInterval(()=>{if(!s)clearInterval(l);else if(s.closed){clearInterval(l),o.removeListener(d);const w=new Error("Window closed");u(w)}},Ai)})}generateState(){return ui(12,Ni)}}const or="x-baas-location";class Ti{constructor(t,r,o){this.fetcher=t,this.oauth2=new Et(r),this.getDeviceInformation=o}async authenticate(t,r){const o=this.getDeviceInformation(),f=typeof r=="object";if(t.providerType.startsWith("oauth2")&&typeof t.payload.redirectUrl=="string"){const u=this.oauth2.generateState(),s=await this.getLogInUrl(t,f,{state:u,redirect:t.payload.redirectUrl,providerRedirectHeader:f?!0:void 0,device:f?void 0:o.encode()});if(f){const d=(await this.fetcher.fetch({method:"GET",url:s,tokenType:f?"access":"none",user:r,mode:"cors",credentials:"include"})).headers.get(or);if(d)return this.openWindowAndWaitForAuthResponse(d,u);throw new Error(`Missing ${or} header`)}else return this.openWindowAndWaitForAuthResponse(s,u)}else{const u=await this.getLogInUrl(t,f),s=await this.fetcher.fetchJSON({method:"POST",url:u,body:{...t.payload,options:{device:o.toJSON()}},tokenType:f?"access":"none",user:r}),{user_id:l,access_token:d,refresh_token:w=null,device_id:m}=s;if(typeof l!="string")throw new Error("Expected a user id in the response");if(typeof d!="string")throw new Error("Expected an access token in the response");if(typeof w!="string"&&w!==null)throw new Error("Expected refresh token to be a string or null");if(typeof m!="string")throw new Error("Expected device id to be a string");return{userId:l,accessToken:d,refreshToken:w,deviceId:m}}}async getLogInUrl(t,r=!1,o={}){const u=this.fetcher.appRoute.authProvider(t.providerName).login(),s=Lr({link:r?"true":void 0,...o});return await this.fetcher.locationUrl+u.path+s}async openWindowAndWaitForAuthResponse(t,r){const o=await this.oauth2.openWindowAndWaitForRedirect(t,r);return Et.decodeAuthInfo(o.userAuth)}}class Vt extends Error{constructor(t,r,o,f,u,s,l){const d=f?`status ${o} ${f}`:`status ${o}`;typeof u=="string"?super(`Request failed (${t} ${r}): ${u} (${d})`):super(`Request failed (${t} ${r}): (${d})`),this.method=t,this.url=r,this.statusText=f,this.statusCode=o,this.error=u,this.errorCode=s,this.link=l}static async fromRequestAndResponse(t,r){var o;const{url:f,method:u}=t,{status:s,statusText:l}=r;if(!((o=r.headers.get("content-type"))===null||o===void 0)&&o.startsWith("application/json")){const d=await r.json();if(typeof d=="object"&&d){const{error:w,error_code:m,link:y}=d;return new Vt(u,f,s,l,typeof w=="string"?w:void 0,typeof m=="string"?m:void 0,typeof y=="string"?y:void 0)}}return new Vt(u,f,s,l)}}function Ii(e){if(typeof e!="object"||e===null)throw new Error("Expected a non-null object");if(Symbol.asyncIterator in e)return e;if("getReader"in e){const t=e;return{[Symbol.asyncIterator](){const r=t.getReader();return{next(){return r.read()},async return(){return await r.cancel(),{done:!0,value:null}}}}}}else throw new Error("Expected an AsyncIterable or a ReadableStream")}class xt{constructor({appId:t,transport:r,userContext:o,locationUrlContext:f}){this.appId=t,this.transport=r,this.userContext=o,this.locationUrlContext=f}static buildAuthorizationHeader(t,r){if(!t||r==="none")return{};if(r==="access")return{Authorization:`Bearer ${t.accessToken}`};if(r==="refresh")return{Authorization:`Bearer ${t.refreshToken}`};throw new Error(`Unexpected token type (${r})`)}static buildBody(t){if(t){if(typeof t=="object"&&t!==null)return JSON.stringify(Rr(t));if(typeof t=="string")return t;throw console.log("body is",t),new Error("Unexpected type of body")}else return}static buildJsonHeader(t){return t&&t.length>0?{"Content-Type":"application/json"}:{}}clone(t){return new xt({appId:this.appId,transport:this.transport,userContext:this.userContext,locationUrlContext:this.locationUrlContext,...t})}async fetch(t){const{path:r,url:o,tokenType:f="access",user:u=this.userContext.currentUser,...s}=t;if(typeof r=="string"&&typeof o=="string")throw new Error("Use of 'url' and 'path' mutually exclusive");if(typeof r=="string"){const l=await this.locationUrlContext.locationUrl+r;return this.fetch({...t,path:void 0,url:l})}else if(typeof o=="string"){const l=await this.transport.fetch({...s,url:o,headers:{...xt.buildAuthorizationHeader(u,f),...t.headers}});if(l.ok)return l;if(u&&l.status===401&&f==="access")return await u.refreshAccessToken(),this.fetch({...t,user:u});throw u&&l.status===401&&f==="refresh"&&(u.accessToken=null,u.refreshToken=null),await Vt.fromRequestAndResponse(t,l)}else throw new Error("Expected either 'url' or 'path'")}async fetchJSON(t){const{body:r}=t,o=xt.buildBody(r),f=xt.buildJsonHeader(o),u=await this.fetch({...t,body:o,headers:{Accept:"application/json",...f,...t.headers}}),s=u.headers.get("content-type");if(s!=null&&s.startsWith("application/json")){const l=await u.json();return kr(l)}else{if(s===null)return null;throw new Error(`Expected JSON response, got "${s}"`)}}async fetchStream(t){const{body:r}=await this.fetch({...t,headers:{Accept:"text/event-stream",...t.headers}});return Ii(r)}get appRoute(){return Z.api().app(this.appId)}get locationUrl(){return this.locationUrlContext.locationUrl}}const Bi="deviceId";var sr;(function(e){e.DEVICE_ID="deviceId",e.APP_ID="appId",e.APP_VERSION="appVersion",e.PLATFORM="platform",e.PLATFORM_VERSION="platformVersion",e.SDK_VERSION="sdkVersion"})(sr||(sr={}));class Ui{constructor({appId:t,appVersion:r,deviceId:o}){this.sdkVersion="2.0.0";const f=Tt();this.platform=f.platform,this.platformVersion=f.platformVersion,this.appId=t,this.appVersion=r,this.deviceId=o}encode(){const t=me(this);return Jt.encode(JSON.stringify(t))}toJSON(){return me(this)}}const Ri="https://realm.mongodb.com";class ot{constructor(t){this.users=[],this._locationUrl=null;const r=typeof t=="string"?{id:t}:t;if(typeof r=="object"&&typeof r.id=="string")this.id=r.id;else throw new Error("Missing an Atlas App Services app-id");this.baseUrl=r.baseUrl||Ri,r.skipLocationRequest&&(this._locationUrl=Promise.resolve(this.baseUrl)),this.localApp=r.app;const{storage:o,transport:f=new et}=r;this.fetcher=new xt({appId:this.id,userContext:this,locationUrlContext:this,transport:f}),this.emailPasswordAuth=new di(this.fetcher);const u=o||Tt().defaultStorage;this.storage=new _i(u,this.id),this.authenticator=new Ti(this.fetcher,u,()=>this.deviceInformation);try{this.hydrate()}catch(s){this.storage.clear(),console.warn("Realm app hydration failed:",s instanceof Error?s.message:s)}}static getApp(t){if(t in ot.appCache)return ot.appCache[t];{const r=new ot(t);return ot.appCache[t]=r,r}}switchUser(t){const r=this.users.findIndex(f=>f===t);if(r===-1)throw new Error("The user was never logged into this app");const[o]=this.users.splice(r,1);this.users.unshift(o)}async logIn(t,r=!0){const o=await this.authenticator.authenticate(t),f=this.createOrUpdateUser(o,t.providerType);this.switchUser(f),r&&await f.refreshProfile(),this.storage.setUserIds(this.users.map(s=>s.id),!0);const u=o.deviceId;return u&&u!=="000000000000000000000000"&&this.storage.set(Bi,u),f}async removeUser(t){const r=this.users.findIndex(o=>o===t);if(r===-1)throw new Error("The user was never logged into this app");this.users.splice(r,1),await t.logOut(),this.storage.remove(`user(${t.id}):profile`),this.storage.removeUserId(t.id)}async deleteUser(t){await this.fetcher.fetchJSON({method:"DELETE",path:Z.api().auth().delete().path}),await this.removeUser(t)}addListener(){throw new Error("Not yet implemented")}removeListener(){throw new Error("Not yet implemented")}removeAllListeners(){throw new Error("Not yet implemented")}get currentUser(){const t=this.users.filter(r=>r.state===at.Active);return t.length===0?null:t[0]}get allUsers(){return Object.fromEntries(this.users.map(t=>[t.id,t]))}get locationUrl(){if(!this._locationUrl){const t=Z.api().app(this.id).location().path;this._locationUrl=this.fetcher.fetchJSON({method:"GET",url:this.baseUrl+t,tokenType:"none"}).then(r=>{if(typeof r!="object")throw new Error("Expected response body be an object");return r}).then(({hostname:r})=>{if(typeof r!="string")throw new Error("Expected response to contain a 'hostname'");return r}).catch(r=>{throw this._locationUrl=null,r})}return this._locationUrl}get deviceInformation(){const t=this.storage.getDeviceId(),r=typeof t=="string"&&t!=="000000000000000000000000"?new J(t):void 0;return new Ui({appId:this.localApp?this.localApp.name:void 0,appVersion:this.localApp?this.localApp.version:void 0,deviceId:r})}createOrUpdateUser(t,r){const o=this.users.find(f=>f.id===t.userId);if(o)return o.accessToken=t.accessToken,o.refreshToken=t.refreshToken,o;{if(!t.refreshToken)throw new Error("No refresh token in response from server");const f=new rr({app:this,id:t.userId,accessToken:t.accessToken,refreshToken:t.refreshToken,providerType:r});return this.users.unshift(f),f}}hydrate(){const t=this.storage.getUserIds();this.users=t.map(r=>new rr({app:this,id:r}))}}ot.appCache={};ot.Credentials=G;const ki=e=>{},Mt=function(e){return e&&e.Math==Math&&e},It=Mt(typeof globalThis=="object"&&globalThis)||Mt(typeof window=="object"&&window)||Mt(typeof self=="object"&&self)||Mt(typeof global=="object"&&global)||function(){return this}()||Function("return this")();ki(typeof __DEV__<"u"&&__DEV__);class Fi{constructor(){if(typeof It.localStorage=="object")this.global=It;else throw new Error("Cannot use LocalStorage without a global localStorage object")}get(t){return this.global.localStorage.getItem(t)}set(t,r){return this.global.localStorage.setItem(t,r)}remove(t){return this.global.localStorage.removeItem(t)}prefix(t){return new K(this,t)}clear(t){const r=[];for(let o=0;o<this.global.localStorage.length;o++){const f=this.global.localStorage.key(o);f&&(!t||f.startsWith(t))&&r.push(f)}for(const o of r)this.global.localStorage.removeItem(o)}addListener(t){return this.global.addEventListener("storage",t)}removeListener(t){return this.global.removeEventListener("storage",t)}}const mt=Jn(),Li="localStorage"in It?Fi:ai;function ji(e){return typeof It.open=="function"?It.open(e):(console.log(`Please open ${e}`),null)}const Di={defaultStorage:new Li().prefix("realm-web"),openWindow:ji,platform:(mt==null?void 0:mt.name)||"web",platformVersion:(mt==null?void 0:mt.version)||"0.0.0",TextDecoder};mi(Di);const Mi=new ot({id:"application-0-czfxu"}),Pi=G.anonymous(),jr=async()=>{let e;try{e=await Mi.logIn(Pi)}catch(t){return console.log("getUser ~ error:",t),!1}return e},$i=async()=>{const e=await jr();if(!(e!=null&&e.isLoggedIn))return;const t=await e.functions.list_registrations();return await e.logOut(),t},Ci=async e=>{console.log("createRegistration ~ data:",e);const t=await jr();if(!(t!=null&&t.isLoggedIn))return;const r=await t.functions.create_registrations(e);return console.log("createRegistration ~ result:",r),await t.logOut(),r};export{Ci as c,$i as l};
